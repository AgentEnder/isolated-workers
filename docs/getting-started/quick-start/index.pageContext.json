{"pageId":"/pages/docs","routeParams":{"splat":"getting-started/quick-start"},"data":{"doc":{"path":"/docs/getting-started/quick-start","filePath":"/home/runner/work/isolated-workers/isolated-workers/docs/getting-started/quick-start.md","title":"Quick Start","description":"Create your first type-safe worker in under 5 minutes","nav":{"section":"Getting Started","order":2}},"segments":[{"type":"html","html":"<h1>Quick Start</h1>\n<p>Create your first type-safe worker in under 5 minutes.</p>\n<h2>Step 1: Define Your Messages</h2>\n<p>The <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/define-messages\">DefineMessages</a></code> type creates a type-safe contract between your host and worker. This ensures that:</p>\n<ul>\n<li>Payload types match on both sides</li>\n<li>Result types are inferred correctly</li>\n<li>TypeScript catches mismatches at compile time</li>\n<li>All message types are properly documented</li>\n</ul>\n<p>This is the foundation of isolated-workers' type safety system.</p>\n<p>First, define the message contract between your host and worker:</p>"},{"type":"code-block","language":"typescript","content":"import { createWorker } from 'isolated-workers';\n\ntype WorkerMessages = DefineMessages<{\n  add: {\n    payload: { a: number; b: number };\n    result: { sum: number };\n  };\n  log: {\n    payload: { message: string };\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> WorkerMessages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  add</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">a</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#FFAB70\">b</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">sum</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  log</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">message</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<h3>Built-in Timeout Keys</h3>\n<p>isolated-workers provides three built-in timeout keys that can be configured when creating a worker:</p>\n<ul>\n<li><code class=\"inline-code\">WORKER_STARTUP</code>: Time to wait for worker process to start (default: 10 seconds)</li>\n<li><code class=\"inline-code\">SERVER_CONNECT</code>: Time for server to wait for host connection (default: 30 seconds)</li>\n<li><code class=\"inline-code\">WORKER_MESSAGE</code>: Default timeout for all messages (default: 5 minutes)</li>\n</ul>\n<p>You can override these defaults or add per-message-type timeouts. See the <a href=\"/isolated-workers/docs/guides/timeout-configuration\">Timeout Configuration</a> guide for details.</p>\n<h2>Step 2: Create the Worker</h2>\n<p>Create a worker file that handles the messages:</p>"},{"type":"code-block","language":"typescript","content":"import { startWorkerServer } from 'isolated-workers';\nimport type { WorkerMessages } from './types';\n\nconst server = await startWorkerServer<WorkerMessages>({\n  add: async ({ a, b }) => {\n    // The result type is checked - returning invalid data will cause a type error\n    return { sum: a + b };\n  },\n  log: async ({ message }) => {\n    console.log('[Worker]', message);\n    // No result needed for one-way messages\n    // One-way message (still waits for acknowledgment from worker)\n  },\n});\n\nconsole.log('Worker server started');","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#F97583\"> type</span><span style=\"color:#E1E4E8\"> { WorkerMessages } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './types'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> server</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">WorkerMessages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  add</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">a</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">b</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // The result type is checked - returning invalid data will cause a type error</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { sum: a </span><span style=\"color:#F97583\">+</span><span style=\"color:#E1E4E8\"> b };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  log</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">message</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'[Worker]'</span><span style=\"color:#E1E4E8\">, message);</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // No result needed for one-way messages</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // One-way message (still waits for acknowledgment from worker)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Worker server started'</span><span style=\"color:#E1E4E8\">);</span></span></code></pre>"},{"type":"html","html":"<h2>Worker Server Options</h2>\n<p>The <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/start-worker-server\">startWorkerServer</a></code> function accepts an optional options object:</p>"},{"type":"code-block","language":"typescript","content":"import { startWorkerServer } from 'isolated-workers';\n\nconst server = await startWorkerServer(handlers, {\n  logLevel: 'debug',        // Enable debug logging\n  middleware: [...],           // Middleware pipeline for message processing\n  serializer: customSerializer,  // Custom message serializer\n  txIdGenerator: customGen,    // Custom transaction ID generator\n});","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> server</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer</a></span><span style=\"color:#E1E4E8\">(handlers, {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  logLevel: </span><span style=\"color:#9ECBFF\">'debug'</span><span style=\"color:#E1E4E8\">,        </span><span style=\"color:#6A737D\">// Enable debug logging</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  middleware: [</span><span style=\"color:#F97583\">...</span><span style=\"color:#E1E4E8\">],           </span><span style=\"color:#6A737D\">// Middleware pipeline for message processing</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  serializer: customSerializer,  </span><span style=\"color:#6A737D\">// Custom message serializer</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  txIdGenerator: customGen,    </span><span style=\"color:#6A737D\">// Custom transaction ID generator</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span></code></pre>"},{"type":"html","html":"<p><strong>Available Options</strong>:</p>\n<ul>\n<li><code class=\"inline-code\">logLevel</code>: 'debug' | 'info' | 'warn' | 'error' - Control logging verbosity</li>\n<li><code class=\"inline-code\">middleware</code>: Middleware[] - Array of middleware functions to process messages</li>\n<li><code class=\"inline-code\">serializer</code>: Serializer - Custom serializer for message serialization</li>\n<li><code class=\"inline-code\">txIdGenerator</code>: Function - Custom transaction ID generator</li>\n</ul>\n<p>These options are optional. Most workers work fine with just the handlers argument.</p>\n<h2>Step 3: Spawn the Worker</h2>\n<p>In your main process, create and communicate with the worker:</p>"},{"type":"code-block","language":"typescript","content":"import { createWorker } from 'isolated-workers';\nimport type { WorkerMessages } from './types';\n\n// Spawn the worker process\nconst worker = await createWorker<WorkerMessages>({\n  script: './worker.js',\n});\n\n// Send messages with full type safety\nconst result = await worker.send('add', { a: 5, b: 3 });\nconsole.log(result.sum); // 8\n\n// One-way message\nawait worker.send('log', { message: 'Hello from host!' });\n\n// Clean up when done\nawait worker.close();","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#F97583\"> type</span><span style=\"color:#E1E4E8\"> { WorkerMessages } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './types'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Spawn the worker process</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">WorkerMessages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  script: </span><span style=\"color:#9ECBFF\">'./worker.js'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Send messages with full type safety</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> result</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">send</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'add'</span><span style=\"color:#E1E4E8\">, { a: </span><span style=\"color:#79B8FF\">5</span><span style=\"color:#E1E4E8\">, b: </span><span style=\"color:#79B8FF\">3</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(result.sum); </span><span style=\"color:#6A737D\">// 8</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// One-way message</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">send</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'log'</span><span style=\"color:#E1E4E8\">, { message: </span><span style=\"color:#9ECBFF\">'Hello from host!'</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Clean up when done</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">close</span><span style=\"color:#E1E4E8\">();</span></span></code></pre>"},{"type":"html","html":"<h3>Error Handling</h3>\n<p>Always handle errors when working with workers:</p>"},{"type":"code-block","language":"typescript","content":"const worker = await createWorker<Messages>({\n  script: './worker.js',\n});\n\ntry {\n  const result = await worker.send('add', { a: 5, b: 3 });\n  console.log(result.sum);\n} catch (err) {\n  // Handle worker errors (timeout, process crash, handler error)\n  console.error('Worker error:', err.message);\n} finally {\n  // Always close the worker when done\n  await worker.close();\n}","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  script: </span><span style=\"color:#9ECBFF\">'./worker.js'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">try</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> result</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">send</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'add'</span><span style=\"color:#E1E4E8\">, { a: </span><span style=\"color:#79B8FF\">5</span><span style=\"color:#E1E4E8\">, b: </span><span style=\"color:#79B8FF\">3</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(result.sum);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">catch</span><span style=\"color:#E1E4E8\"> (err) {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Handle worker errors (timeout, process crash, handler error)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  console.</span><span style=\"color:#B392F0\">error</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Worker error:'</span><span style=\"color:#E1E4E8\">, err.message);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">finally</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Always close the worker when done</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">close</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>"},{"type":"html","html":"<h2>Graceful Shutdown</h2>\n<p>Always close workers when done to ensure clean shutdown:</p>"},{"type":"code-block","language":"typescript","content":"const worker = await createWorker<Messages>({\n  script: './worker.js',\n});\n\ntry {\n  await doWork(worker);\n} finally {\n  // Always close to terminate worker process and clean up resources\n  await worker.close();\n}","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  script: </span><span style=\"color:#9ECBFF\">'./worker.js'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">try</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#B392F0\"> doWork</span><span style=\"color:#E1E4E8\">(worker);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">finally</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Always close to terminate worker process and clean up resources</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">close</span><span style=\"color:#E1E4E8\">();</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>"},{"type":"html","html":"<p>The <code class=\"inline-code\">close()</code> method:</p>\n<ul>\n<li>Rejects all pending requests</li>\n<li>Sends SIGTERM to worker process</li>\n<li>Waits up to 5 seconds for graceful exit</li>\n<li>Force-kills if needed</li>\n<li>Cleans up socket files</li>\n</ul>\n<p>This prevents resource leaks and orphaned processes.</p>\n<h2>That's It!</h2>\n<p>You now have a type-safe worker running in a separate process. The key benefits:</p>\n<ul>\n<li>Full type inference on both host and worker sides</li>\n<li>Autocomplete for payloads and results</li>\n<li>Compile-time type checking for all message contracts</li>\n<li>True process isolation</li>\n</ul>\n<h2>Next Steps</h2>\n<p>Continue to <a href=\"/isolated-workers/docs/getting-started/first-worker\">First Worker</a> for a more complete example, or explore the <a href=\"/isolated-workers/docs/guides\">Guides</a> for advanced patterns.</p>"}]}}