{"pageId":"/pages/docs","routeParams":{"splat":"guides/timeout-configuration"},"data":{"doc":{"path":"/docs/guides/timeout-configuration","filePath":"/home/runner/work/isolated-workers/isolated-workers/docs/guides/timeout-configuration.md","title":"Timeout Configuration","description":"Configure timeouts for worker lifecycle and message operations","nav":{"section":"Guides","order":3}},"segments":[{"type":"html","html":"<h1>Timeout Configuration</h1>\n<p>isolated-workers provides flexible timeout configuration for different phases of worker operation. You can set global defaults and per-message-type overrides for fine-grained control.</p>\n<h2>Timeout Types</h2>\n<p>There are three categories of timeouts:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Timeout</th><th>Default</th><th>Purpose</th></tr></thead><tbody><tr><td><code class=\"inline-code\">WORKER_STARTUP</code></td><td>10 seconds</td><td>Time for worker process to start</td></tr><tr><td><code class=\"inline-code\">SERVER_CONNECT</code></td><td>30 seconds</td><td>Time for worker to accept connection</td></tr><tr><td><code class=\"inline-code\">WORKER_MESSAGE</code></td><td>5 minutes</td><td>Default timeout for all messages</td></tr></tbody></table>\n<p>You can also set <strong>per-message-type timeouts</strong> that override <code class=\"inline-code\">WORKER_MESSAGE</code> for specific operations.</p>\n<h2>Basic Configuration</h2>\n<p>Pass a timeout configuration object to <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/create-worker\">createWorker</a></code>:</p>"},{"type":"file","filename":"host.ts","language":"typescript","content":"// Define timeout configuration\n  const timeoutConfig: TimeoutConfig<Messages> = {\n    // Worker lifecycle timeouts\n    WORKER_STARTUP: 5000, // 5 seconds to start\n    SERVER_CONNECT: 5000, // 5 seconds for server to accept connection\n\n    // Default message timeout\n    WORKER_MESSAGE: 3000, // 3 seconds default for messages\n\n    // Per-message-type timeouts (override WORKER_MESSAGE)\n    quickPing: 1000, // 1 second for quick operations\n    slowProcess: 10000, // 10 seconds for slow operations\n  };","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Define timeout configuration</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> timeoutConfig</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/timeout-config\" class=\"code-link\" title=\"View TimeoutConfig documentation\">TimeoutConfig</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Worker lifecycle timeouts</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    WORKER_STARTUP: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 5 seconds to start</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    SERVER_CONNECT: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 5 seconds for server to accept connection</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Default message timeout</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    WORKER_MESSAGE: </span><span style=\"color:#79B8FF\">3000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 3 seconds default for messages</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Per-message-type timeouts (override WORKER_MESSAGE)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    quickPing: </span><span style=\"color:#79B8FF\">1000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 1 second for quick operations</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    slowProcess: </span><span style=\"color:#79B8FF\">10000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 10 seconds for slow operations</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span></code></pre>"},{"type":"html","html":"<p>Then use it when creating the worker:</p>"},{"type":"file","filename":"host.ts","language":"typescript","content":"const worker = await createWorker<Messages>({\n    script: join(__dirname, 'worker.ts'),\n    timeout: timeoutConfig,\n  });","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    script: </span><span style=\"color:#B392F0\">join</span><span style=\"color:#E1E4E8\">(__dirname, </span><span style=\"color:#9ECBFF\">'worker.ts'</span><span style=\"color:#E1E4E8\">),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    timeout: timeoutConfig,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  });</span></span></code></pre>"},{"type":"html","html":"<h2>Type-Safe Configuration</h2>\n<p>The <code class=\"inline-code\">TimeoutConfig<t></t></code> type provides autocomplete for your message types:</p>"},{"type":"code-block","language":"typescript","content":"import { createWorker, type TimeoutConfig } from 'isolated-workers';\n\n// TypeScript knows your message types and offers autocomplete\nconst timeout: TimeoutConfig<Messages> = {\n  WORKER_STARTUP: 5000,\n  WORKER_MESSAGE: 3000,\n  quickPing: 1000, // ← Autocomplete for your message types\n  slowProcess: 10000,\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a>, </span><span style=\"color:#F97583\">type</span><span style=\"color:#E1E4E8\"> <a href=\"/isolated-workers/api/timeout-config\" class=\"code-link\" title=\"View TimeoutConfig documentation\">TimeoutConfig</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// TypeScript knows your message types and offers autocomplete</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> timeout</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/timeout-config\" class=\"code-link\" title=\"View TimeoutConfig documentation\">TimeoutConfig</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  WORKER_STARTUP: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  WORKER_MESSAGE: </span><span style=\"color:#79B8FF\">3000</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  quickPing: </span><span style=\"color:#79B8FF\">1000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// ← Autocomplete for your message types</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  slowProcess: </span><span style=\"color:#79B8FF\">10000</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h2>When Timeouts Trigger</h2>\n<p><strong>WORKER_STARTUP</strong> - If the worker process doesn't start within this time, <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/create-worker\">createWorker</a></code> throws. This can happen if:</p>\n<ul>\n<li>The script path is wrong</li>\n<li>The script has syntax errors</li>\n<li>Node.js can't be found</li>\n</ul>\n<p><strong>SERVER_CONNECT</strong> - If the worker starts but doesn't establish a connection within this time, an error is thrown. This can happen if:</p>\n<ul>\n<li>The worker script doesn't call <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/start-worker-server\">startWorkerServer</a></code></li>\n<li>Network/socket issues prevent connection</li>\n</ul>\n<p><strong>WORKER_MESSAGE / per-type</strong> - If a message doesn't receive a response within its timeout, the pending promise rejects. This can happen if:</p>\n<ul>\n<li>The handler takes too long</li>\n<li>The worker crashes during processing</li>\n<li>The handler is stuck in an infinite loop</li>\n</ul>\n<h2>Best Practices</h2>\n<h3>1. Set Per-Type Timeouts for Long Operations</h3>"},{"type":"code-block","language":"typescript","content":"const timeout: TimeoutConfig<Messages> = {\n  WORKER_MESSAGE: 5000, // 5s default\n  processImage: 60000, // 1 minute for image processing\n  batchExport: 300000, // 5 minutes for batch operations\n  healthCheck: 1000, // 1 second for quick checks\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> timeout</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/timeout-config\" class=\"code-link\" title=\"View TimeoutConfig documentation\">TimeoutConfig</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  WORKER_MESSAGE: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 5s default</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  processImage: </span><span style=\"color:#79B8FF\">60000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 1 minute for image processing</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  batchExport: </span><span style=\"color:#79B8FF\">300000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 5 minutes for batch operations</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  healthCheck: </span><span style=\"color:#79B8FF\">1000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 1 second for quick checks</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>2. Keep Startup Timeouts Short</h3>\n<p>Workers should start quickly. A long startup timeout might mask underlying issues:</p>"},{"type":"code-block","language":"typescript","content":"const timeout: TimeoutConfig<Messages> = {\n  WORKER_STARTUP: 5000, // 5s is usually plenty\n  SERVER_CONNECT: 5000, // Connection should be fast\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> timeout</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/timeout-config\" class=\"code-link\" title=\"View TimeoutConfig documentation\">TimeoutConfig</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  WORKER_STARTUP: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// 5s is usually plenty</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  SERVER_CONNECT: </span><span style=\"color:#79B8FF\">5000</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// Connection should be fast</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>3. Handle Timeout Errors</h3>\n<p>Timeout errors are thrown as regular errors - catch and handle them appropriately:</p>"},{"type":"code-block","language":"typescript","content":"try {\n  await worker.send('slowOperation', { data });\n} catch (error) {\n  if (error.message.includes('timeout')) {\n    console.log('Operation took too long, retrying...');\n    // Implement retry logic\n  }\n  throw error;\n}","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">try</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">send</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'slowOperation'</span><span style=\"color:#E1E4E8\">, { data });</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">catch</span><span style=\"color:#E1E4E8\"> (error) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  if</span><span style=\"color:#E1E4E8\"> (error.message.</span><span style=\"color:#B392F0\">includes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'timeout'</span><span style=\"color:#E1E4E8\">)) {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Operation took too long, retrying...'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Implement retry logic</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  throw</span><span style=\"color:#E1E4E8\"> error;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>"},{"type":"html","html":"<h2>Numeric Shorthand</h2>\n<p>If you only need a single timeout value for all operations, pass a number:</p>"},{"type":"code-block","language":"typescript","content":"// All operations timeout after 30 seconds\nconst worker = await createWorker<Messages>({\n  script: './worker.js',\n  timeout: 30000,\n});","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// All operations timeout after 30 seconds</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  script: </span><span style=\"color:#9ECBFF\">'./worker.js'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  timeout: </span><span style=\"color:#79B8FF\">30000</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span></code></pre>"},{"type":"html","html":"<h2>See Also</h2>\n<ul>\n<li>{% example-link timeout-config %} - Complete timeout configuration example</li>\n<li><a href=\"/isolated-workers/docs/guides/worker-lifecycle\">Worker Lifecycle</a> - Managing worker state</li>\n</ul>"}]}}