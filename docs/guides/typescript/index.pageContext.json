{"pageId":"/pages/docs","routeParams":{"splat":"guides/typescript"},"data":{"doc":{"path":"/docs/guides/typescript","filePath":"/home/runner/work/isolated-workers/isolated-workers/docs/guides/typescript.md","title":"TypeScript Deep Dive","description":"Advanced TypeScript patterns and type extraction helpers","nav":{"section":"Guides","order":6}},"segments":[{"type":"html","html":"<h1>TypeScript Deep Dive</h1>\n<p>This guide explores advanced TypeScript patterns that power isolated-workers' type safety. Understanding these patterns will help you leverage full type inference and catch errors at compile time.</p>\n<h2>The DefineMessages Pattern</h2>\n<p>At the heart of isolated-workers is the <code class=\"inline-code\"><a class=\"code-link\" href=\"/isolated-workers/isolated-workers/api/define-messages\">DefineMessages</a></code> pattern - a type constructor that defines your message contracts between host and worker.</p>\n<h3>Basic Structure</h3>"},{"type":"code-block","language":"typescript","content":"import { DefineMessages } from 'isolated-workers';\n\ntype Messages = DefineMessages<{\n  messageName: {\n    payload: {\n      /* data sent to worker */\n    };\n    result: {\n      /* data returned from worker */\n    };\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  messageName</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">      /* data sent to worker */</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">      /* data returned from worker */</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<p>Each message definition consists of:</p>\n<ul>\n<li><strong>payload</strong>: The data sent with the message (required)</li>\n<li><strong>result</strong>: The data returned from the handler (optional)</li>\n</ul>\n<h3>Messages With and Without Results</h3>\n<p>Messages that expect a response include a <code class=\"inline-code\">result</code>:</p>"},{"type":"code-block","language":"typescript","content":"type Messages = DefineMessages<{\n  // Request/response pattern - has result\n  compute: {\n    payload: { values: number[] };\n    result: { sum: number };\n  };\n\n  // Fire-and-forget pattern - no result\n  logEvent: {\n    payload: { event: string; timestamp: number };\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Request/response pattern - has result</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  compute</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">values</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">[] };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">sum</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Fire-and-forget pattern - no result</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  logEvent</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">event</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#FFAB70\">timestamp</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<h3>Void Payloads</h3>\n<p>For messages that need no input data, use <code class=\"inline-code\">void</code> or <code class=\"inline-code\">Record<string, never=\"\"></string,></code>:</p>"},{"type":"code-block","language":"typescript","content":"type Messages = DefineMessages<{\n  // Using void for no payload\n  shutdown: {\n    payload: void;\n  };\n\n  // Using empty record (recommended for clarity)\n  getStatus: {\n    payload: Record<string, never>;\n    result: { uptime: number };\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Using void for no payload</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  shutdown</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> void</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Using empty record (recommended for clarity)</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  getStatus</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Record</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#79B8FF\">string</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">never</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">uptime</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<p>The empty record pattern is clearer because it explicitly shows \"this message takes no data\" rather than \"this message takes undefined\".</p>\n<h2>Type Inference</h2>\n<p>TypeScript automatically infers types throughout the system. Here's how it flows:</p>\n<h3>From Message Definition to Handler</h3>\n<p>When you define handlers, TypeScript infers parameter and return types:</p>"},{"type":"code-block","language":"typescript","content":"import { Handlers } from 'isolated-workers';\n\ntype Messages = DefineMessages<{\n  greet: {\n    payload: { name: string };\n    result: { greeting: string };\n  };\n}>;\n\nconst handlers: Handlers<Messages> = {\n  // TypeScript knows:\n  // - payload is { name: string }\n  // - return must be { greeting: string }\n  greet: (payload) => {\n    return { greeting: `Hello, ${payload.name}!` };\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  greet</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">name</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">greeting</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // TypeScript knows:</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // - payload is { name: string }</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // - return must be { greeting: string }</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  greet</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { greeting: </span><span style=\"color:#9ECBFF\">`Hello, ${</span><span style=\"color:#E1E4E8\">payload</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">name</span><span style=\"color:#9ECBFF\">}!`</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>From Message Definition to Worker Client</h3>\n<p>When sending messages from the host, types flow automatically:</p>"},{"type":"code-block","language":"typescript","content":"const worker = await createWorker<Messages>({\n  workerPath: './worker.js',\n});\n\n// TypeScript knows:\n// - First argument must match 'greet' | 'compute' | etc.\n// - Second argument must match that message's payload\n// - Return type is a Promise of that message's result\nconst result = await worker.send('greet', { name: 'World' });\n// result is typed as { greeting: string }","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> worker</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  workerPath: </span><span style=\"color:#9ECBFF\">'./worker.js'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// TypeScript knows:</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// - First argument must match 'greet' | 'compute' | etc.</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// - Second argument must match that message's payload</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// - Return type is a Promise of that message's result</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> result</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> worker.</span><span style=\"color:#B392F0\">send</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'greet'</span><span style=\"color:#E1E4E8\">, { name: </span><span style=\"color:#9ECBFF\">'World'</span><span style=\"color:#E1E4E8\"> });</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// result is typed as { greeting: string }</span></span></code></pre>"},{"type":"html","html":"<h2>Type Extraction Helpers</h2>\n<p>The library provides several helper types for extracting specific parts of your message definitions.</p>\n<h3>MessageOf&#x3C;T, K></h3>\n<p>Extracts the full message type for a given key, including <code class=\"inline-code\">tx</code> and <code class=\"inline-code\">type</code> fields:</p>"},{"type":"code-block","language":"typescript","content":"import { DefineMessages, MessageOf } from 'isolated-workers';\n\ntype Messages = DefineMessages<{\n  load: { payload: { config: string }; result: { loaded: true } };\n}>;\n\ntype LoadMessage = MessageOf<Messages, 'load'>;\n// Equivalent to:\n// {\n//   tx: string;\n//   type: 'load';\n//   payload: { config: string };\n// }","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a>, <a href=\"/isolated-workers/api/message-of\" class=\"code-link\" title=\"View MessageOf documentation\">MessageOf</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  load</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">config</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">loaded</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> true</span><span style=\"color:#E1E4E8\"> } };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> LoadMessage</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/message-of\" class=\"code-link\" title=\"View MessageOf documentation\">MessageOf</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'load'</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Equivalent to:</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   tx: string;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   type: 'load';</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   payload: { config: string };</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// }</span></span></code></pre>"},{"type":"html","html":"<p>This is useful for middleware or custom message handling.</p>\n<h3>ResultOf&#x3C;T, K></h3>\n<p>Extracts the full result type for a given key:</p>"},{"type":"code-block","language":"typescript","content":"type LoadResult = ResultOf<Messages, 'load'>;\n// Equivalent to:\n// {\n//   tx: string;\n//   type: 'loadResult';\n//   payload: { loaded: true };\n// }","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> LoadResult</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/result-of\" class=\"code-link\" title=\"View ResultOf documentation\">ResultOf</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'load'</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Equivalent to:</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   tx: string;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   type: 'loadResult';</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//   payload: { loaded: true };</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// }</span></span></code></pre>"},{"type":"html","html":"<p>Note how the type becomes <code class=\"inline-code\">'loadResult'</code> - the library automatically appends \"Result\" to differentiate responses.</p>\n<h3>WithResult<t></t></h3>\n<p>Extracts keys that have a result defined (useful for conditional types):</p>"},{"type":"code-block","language":"typescript","content":"type Messages = DefineMessages<{\n  load: { payload: {}; result: {} }; // Has result\n  shutdown: { payload: {} }; // No result\n}>;\n\ntype MessagesWithResult = WithResult<Messages>;\n// Type is: 'load'","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  load</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {}; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {} }; </span><span style=\"color:#6A737D\">// Has result</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  shutdown</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {} }; </span><span style=\"color:#6A737D\">// No result</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> MessagesWithResult</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/with-result\" class=\"code-link\" title=\"View WithResult documentation\">WithResult</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Type is: 'load'</span></span></code></pre>"},{"type":"html","html":"<h3>AnyMessage<t></t></h3>\n<p>Creates a union of all possible message types (requests and responses):</p>"},{"type":"code-block","language":"typescript","content":"type AllMessages = AnyMessage<Messages>;\n// Union of all MessageOf<Messages, K> and ResultOf<Messages, K>","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/all-messages\" class=\"code-link\" title=\"View AllMessages documentation\">AllMessages</a></span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/any-message\" class=\"code-link\" title=\"View AnyMessage documentation\">AnyMessage</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Union of all MessageOf&#x3C;Messages, K> and ResultOf&#x3C;Messages, K></span></span></code></pre>"},{"type":"html","html":"<p>This is particularly useful for middleware that needs to handle any message:</p>"},{"type":"code-block","language":"typescript","content":"import { Middleware, AnyMessage } from 'isolated-workers';\n\nconst logger: Middleware<Messages> = (msg: AnyMessage<Messages>, direction) => {\n  console.log(`[${direction}] ${msg.type}`);\n  return msg;\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/middleware\" class=\"code-link\" title=\"View Middleware documentation\">Middleware</a>, <a href=\"/isolated-workers/api/any-message\" class=\"code-link\" title=\"View AnyMessage documentation\">AnyMessage</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#B392F0\"> logger</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/middleware\" class=\"code-link\" title=\"View Middleware documentation\">Middleware</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">msg</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/any-message\" class=\"code-link\" title=\"View AnyMessage documentation\">AnyMessage</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">>, </span><span style=\"color:#FFAB70\">direction</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`[${</span><span style=\"color:#E1E4E8\">direction</span><span style=\"color:#9ECBFF\">}] ${</span><span style=\"color:#E1E4E8\">msg</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">type</span><span style=\"color:#9ECBFF\">}`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> msg;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>PayloadOf and ResultPayloadOf</h3>\n<p>Extract just the payload or result payload types without the wrapper:</p>"},{"type":"code-block","language":"typescript","content":"import { PayloadOf, ResultPayloadOf } from 'isolated-workers';\n\ntype LoadPayload = PayloadOf<Messages, 'load'>;\n// { config: string }\n\ntype LoadResultPayload = ResultPayloadOf<Messages, 'load'>;\n// { loaded: true }","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/payload-of\" class=\"code-link\" title=\"View PayloadOf documentation\">PayloadOf</a>, <a href=\"/isolated-workers/api/result-payload-of\" class=\"code-link\" title=\"View ResultPayloadOf documentation\">ResultPayloadOf</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> LoadPayload</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/payload-of\" class=\"code-link\" title=\"View PayloadOf documentation\">PayloadOf</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'load'</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// { config: string }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> LoadResultPayload</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/result-payload-of\" class=\"code-link\" title=\"View ResultPayloadOf documentation\">ResultPayloadOf</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'load'</span><span style=\"color:#E1E4E8\">>;</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// { loaded: true }</span></span></code></pre>"},{"type":"html","html":"<h2>The Handlers Type</h2>\n<p>The <code class=\"inline-code\">Handlers<t></t></code> type enforces that you implement handlers for every message in your definition:</p>"},{"type":"code-block","language":"typescript","content":"import { Handlers } from 'isolated-workers';\n\ntype Messages = DefineMessages<{\n  ping: { payload: { message: string }; result: { message: string } };\n  shutdown: { payload: void };\n}>;\n\n// TypeScript ensures all handlers are present and correctly typed\nconst handlers: Handlers<Messages> = {\n  ping: (payload) => {\n    // payload is { message: string }\n    return { message: 'pong' }; // Must return { message: string }\n  },\n\n  shutdown: () => {\n    // payload is void, return is void\n    console.log('Shutting down...');\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a> } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  ping</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">message</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">message</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> } };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  shutdown</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> void</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// TypeScript ensures all handlers are present and correctly typed</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  ping</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // payload is { message: string }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { message: </span><span style=\"color:#9ECBFF\">'pong'</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#6A737D\">// Must return { message: string }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  shutdown</span><span style=\"color:#E1E4E8\">: () </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // payload is void, return is void</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'Shutting down...'</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>Handler Return Types</h3>\n<p>Handlers support both synchronous and asynchronous returns:</p>"},{"type":"code-block","language":"typescript","content":"const handlers: Handlers<Messages> = {\n  // Sync handler\n  ping: (payload) => ({ message: 'pong' }),\n\n  // Async handler\n  compute: async (payload) => {\n    const result = await heavyComputation(payload.values);\n    return { sum: result };\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Sync handler</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  ping</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> ({ message: </span><span style=\"color:#9ECBFF\">'pong'</span><span style=\"color:#E1E4E8\"> }),</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Async handler</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  compute</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> result</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> heavyComputation</span><span style=\"color:#E1E4E8\">(payload.values);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { sum: result };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<p>The <code class=\"inline-code\">MaybePromise<t></t></code> utility type handles this automatically.</p>\n<h3>Missing Handler Detection</h3>\n<p>If you forget a handler, TypeScript catches it:</p>"},{"type":"code-block","language":"typescript","content":"const handlers: Handlers<Messages> = {\n  ping: (payload) => ({ message: 'pong' }),\n  // Error: Property 'shutdown' is missing in type...\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  ping</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> ({ message: </span><span style=\"color:#9ECBFF\">'pong'</span><span style=\"color:#E1E4E8\"> }),</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Error: Property 'shutdown' is missing in type...</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>Incorrect Return Type Detection</h3>\n<p>Wrong return types are caught at compile time:</p>"},{"type":"code-block","language":"typescript","content":"const handlers: Handlers<Messages> = {\n  ping: (payload) => {\n    return { msg: 'pong' }; // Error: 'msg' does not exist, expected 'message'\n  },\n  shutdown: () => {},\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  ping</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { msg: </span><span style=\"color:#9ECBFF\">'pong'</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#6A737D\">// Error: 'msg' does not exist, expected 'message'</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  shutdown</span><span style=\"color:#E1E4E8\">: () </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {},</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h2>Strict Mode Benefits</h2>\n<p>We strongly recommend enabling TypeScript strict mode for isolated-workers projects:</p>"},{"type":"code-block","language":"json","content":"{\n  \"compilerOptions\": {\n    \"strict\": true\n  }\n}","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">{</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">  \"compilerOptions\"</span><span style=\"color:#E1E4E8\">: {</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    \"strict\"</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">true</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>"},{"type":"html","html":"<h3>strictNullChecks</h3>\n<p>Catches potential null/undefined errors in payloads:</p>"},{"type":"code-block","language":"typescript","content":"type Messages = DefineMessages<{\n  process: {\n    payload: { value: number | null };\n    result: { doubled: number };\n  };\n}>;\n\nconst handlers: Handlers<Messages> = {\n  process: (payload) => {\n    // Error: Object is possibly 'null'\n    return { doubled: payload.value * 2 };\n\n    // Correct:\n    if (payload.value === null) {\n      return { doubled: 0 };\n    }\n    return { doubled: payload.value * 2 };\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  process</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">value</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#F97583\"> |</span><span style=\"color:#79B8FF\"> null</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">doubled</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  process</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Error: Object is possibly 'null'</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { doubled: payload.value </span><span style=\"color:#F97583\">*</span><span style=\"color:#79B8FF\"> 2</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Correct:</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    if</span><span style=\"color:#E1E4E8\"> (payload.value </span><span style=\"color:#F97583\">===</span><span style=\"color:#79B8FF\"> null</span><span style=\"color:#E1E4E8\">) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      return</span><span style=\"color:#E1E4E8\"> { doubled: </span><span style=\"color:#79B8FF\">0</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { doubled: payload.value </span><span style=\"color:#F97583\">*</span><span style=\"color:#79B8FF\"> 2</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>noImplicitAny</h3>\n<p>Ensures all types are explicitly defined:</p>"},{"type":"code-block","language":"typescript","content":"// Without noImplicitAny, this would silently be 'any'\nconst handlers: Handlers<Messages> = {\n  ping: (payload) => {\n    // payload is properly typed, not 'any'\n    return { message: payload.message.toUpperCase() };\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// Without noImplicitAny, this would silently be 'any'</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  ping</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // payload is properly typed, not 'any'</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { message: payload.message.</span><span style=\"color:#B392F0\">toUpperCase</span><span style=\"color:#E1E4E8\">() };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h2>Common Type Patterns</h2>\n<h3>Discriminated Unions</h3>\n<p>For messages with multiple variants, use discriminated unions:</p>"},{"type":"code-block","language":"typescript","content":"type Result =\n  | { success: true; data: string }\n  | { success: false; error: string };\n\ntype Messages = DefineMessages<{\n  fetch: {\n    payload: { url: string };\n    result: Result;\n  };\n}>;\n\nconst handlers: Handlers<Messages> = {\n  fetch: async (payload) => {\n    try {\n      const data = await fetchData(payload.url);\n      return { success: true, data };\n    } catch (err) {\n      return { success: false, error: String(err) };\n    }\n  },\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Result</span><span style=\"color:#F97583\"> =</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  |</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">success</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> true</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  |</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">success</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> false</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#FFAB70\">error</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  fetch</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">url</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Result</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#79B8FF\"> handlers</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  fetch</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    try</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      const</span><span style=\"color:#79B8FF\"> data</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> fetchData</span><span style=\"color:#E1E4E8\">(payload.url);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      return</span><span style=\"color:#E1E4E8\"> { success: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\">, data };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    } </span><span style=\"color:#F97583\">catch</span><span style=\"color:#E1E4E8\"> (err) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      return</span><span style=\"color:#E1E4E8\"> { success: </span><span style=\"color:#79B8FF\">false</span><span style=\"color:#E1E4E8\">, error: </span><span style=\"color:#B392F0\">String</span><span style=\"color:#E1E4E8\">(err) };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h3>Generic Patterns</h3>\n<p>You can build generic message sets:</p>"},{"type":"code-block","language":"typescript","content":"type CRUDMessages<T> = DefineMessages<{\n  create: { payload: Omit<T, 'id'>; result: T };\n  read: { payload: { id: string }; result: T | null };\n  update: { payload: T; result: T };\n  delete: { payload: { id: string }; result: { deleted: boolean } };\n}>;\n\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n}\n\ntype UserMessages = CRUDMessages<User>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> CRUDMessages</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">T</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  create</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Omit</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">T</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">'id'</span><span style=\"color:#E1E4E8\">>; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> T</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  read</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">id</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> T</span><span style=\"color:#F97583\"> |</span><span style=\"color:#79B8FF\"> null</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  update</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> T</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> T</span><span style=\"color:#E1E4E8\"> };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  delete</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">id</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\"> }; </span><span style=\"color:#FFAB70\">result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">deleted</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> boolean</span><span style=\"color:#E1E4E8\"> } };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">interface</span><span style=\"color:#B392F0\"> User</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  id</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  name</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  email</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> UserMessages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> CRUDMessages</span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">User</span><span style=\"color:#E1E4E8\">>;</span></span></code></pre>"},{"type":"html","html":"<h3>Complex Nested Payloads</h3>\n<p>For complex data, define types separately for clarity:</p>"},{"type":"code-block","language":"typescript","content":"interface ImageOptions {\n  grayscale: boolean;\n  quality: number;\n}\n\ninterface ImageMetadata {\n  width: number;\n  height: number;\n  format: string;\n  size: number;\n}\n\ntype Messages = DefineMessages<{\n  processImage: {\n    payload: {\n      imagePath: string;\n      options: ImageOptions;\n    };\n    result: ImageMetadata;\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">interface</span><span style=\"color:#B392F0\"> ImageOptions</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  grayscale</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> boolean</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  quality</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">interface</span><span style=\"color:#B392F0\"> ImageMetadata</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  width</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  height</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  format</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  size</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  processImage</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      imagePath</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      options</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ImageOptions</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> ImageMetadata</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<h3>Optional Fields in Payloads</h3>\n<p>Use TypeScript's optional syntax for optional fields:</p>"},{"type":"code-block","language":"typescript","content":"type Messages = DefineMessages<{\n  query: {\n    payload: {\n      search: string;\n      limit?: number; // Optional\n      offset?: number; // Optional\n    };\n    result: { items: string[] };\n  };\n}>;","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">type</span><span style=\"color:#B392F0\"> Messages</span><span style=\"color:#F97583\"> =</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/define-messages\" class=\"code-link\" title=\"View DefineMessages documentation\">DefineMessages</a></span><span style=\"color:#E1E4E8\">&#x3C;{</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">  query</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    payload</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      search</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      limit</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#6A737D\">// Optional</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">      offset</span><span style=\"color:#F97583\">?:</span><span style=\"color:#79B8FF\"> number</span><span style=\"color:#E1E4E8\">; </span><span style=\"color:#6A737D\">// Optional</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    };</span></span>\n<span class=\"line\"><span style=\"color:#FFAB70\">    result</span><span style=\"color:#F97583\">:</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#FFAB70\">items</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> string</span><span style=\"color:#E1E4E8\">[] };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  };</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}>;</span></span></code></pre>"},{"type":"html","html":"<h2>Middleware Types</h2>\n<p>For type-safe middleware, use the <code class=\"inline-code\">Middleware<t></t></code> and <code class=\"inline-code\">TransactionIdGenerator<t></t></code> types:</p>"},{"type":"code-block","language":"typescript","content":"import {\n  Middleware,\n  TransactionIdGenerator,\n  AnyMessage,\n} from 'isolated-workers';\n\n// Type-safe middleware\nconst logMiddleware: Middleware<Messages> = (message, direction) => {\n  console.log(`[${direction}] ${message.type}`);\n  return message;\n};\n\n// Custom transaction ID generator\nconst customTxGen: TransactionIdGenerator<Messages> = (message) => {\n  return `${message.type}-${Date.now()}-${Math.random().toString(36).slice(2)}`;\n};","highlightedHtml":"<pre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  <a href=\"/isolated-workers/api/middleware\" class=\"code-link\" title=\"View Middleware documentation\">Middleware</a>,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  <a href=\"/isolated-workers/api/transaction-id-generator\" class=\"code-link\" title=\"View TransactionIdGenerator documentation\">TransactionIdGenerator</a>,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  <a href=\"/isolated-workers/api/any-message\" class=\"code-link\" title=\"View AnyMessage documentation\">AnyMessage</a>,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">} </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> 'isolated-workers'</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Type-safe middleware</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#B392F0\"> logMiddleware</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/middleware\" class=\"code-link\" title=\"View Middleware documentation\">Middleware</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">message</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">direction</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  console.</span><span style=\"color:#B392F0\">log</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`[${</span><span style=\"color:#E1E4E8\">direction</span><span style=\"color:#9ECBFF\">}] ${</span><span style=\"color:#E1E4E8\">message</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">type</span><span style=\"color:#9ECBFF\">}`</span><span style=\"color:#E1E4E8\">);</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> message;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Custom transaction ID generator</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">const</span><span style=\"color:#B392F0\"> customTxGen</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> <a href=\"/isolated-workers/api/transaction-id-generator\" class=\"code-link\" title=\"View TransactionIdGenerator documentation\">TransactionIdGenerator</a></span><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#B392F0\">Messages</span><span style=\"color:#E1E4E8\">> </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">message</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#9ECBFF\"> `${</span><span style=\"color:#E1E4E8\">message</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">type</span><span style=\"color:#9ECBFF\">}-${</span><span style=\"color:#E1E4E8\">Date</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#B392F0\">now</span><span style=\"color:#9ECBFF\">()</span><span style=\"color:#9ECBFF\">}-${</span><span style=\"color:#E1E4E8\">Math</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#B392F0\">random</span><span style=\"color:#9ECBFF\">().</span><span style=\"color:#B392F0\">toString</span><span style=\"color:#9ECBFF\">(</span><span style=\"color:#79B8FF\">36</span><span style=\"color:#9ECBFF\">).</span><span style=\"color:#B392F0\">slice</span><span style=\"color:#9ECBFF\">(</span><span style=\"color:#79B8FF\">2</span><span style=\"color:#9ECBFF\">)</span><span style=\"color:#9ECBFF\">}`</span><span style=\"color:#E1E4E8\">;</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">};</span></span></code></pre>"},{"type":"html","html":"<h2>See Also</h2>\n<ul>\n<li><a href=\"/isolated-workers/docs/guides/middleware\">Middleware</a> - Using middleware for message inspection</li>\n<li><a href=\"/isolated-workers/docs/guides/error-handling\">Error Handling</a> - Type-safe error propagation</li>\n<li>{% example-link basic-ping %} - Simple typed message example</li>\n<li>{% example-link image-processing %} - Complex payload example</li>\n</ul>"}]}}