<!DOCTYPE html>
    <html lang="en">
      <head>
        <link rel="stylesheet" type="text/css" href="/isolated-workers/assets/static/pages_tailwind-65fb2459.DWwu-Xsw.css">
        <meta charset="UTF-8" />
        
        
    <title>isolated-workers</title><meta property="og:title" content="isolated-workers" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="data:image/svg+xml,%3csvg%20width=&#x27;48&#x27;%20height=&#x27;48&#x27;%20viewBox=&#x27;0%200%2048%2048&#x27;%20fill=&#x27;none&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3e%3c!--%20Background%20hexagon%20representing%20the%20isolated%20container%20--%3e%3cpath%20d=&#x27;M24%204L42%2014V34L24%2044L6%2034V14L24%204Z&#x27;%20fill=&#x27;%231a1a2e&#x27;%20stroke=&#x27;%234a5568&#x27;%20stroke-width=&#x27;1.5&#x27;/%3e%3c!--%20Inner%20isolated%20worker%20cells%20--%3e%3c!--%20Top%20worker%20--%3e%3cg%20transform=&#x27;translate(24,%2012)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%233b82f6&#x27;%20stroke=&#x27;%2360a5fa&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Bottom-left%20worker%20--%3e%3cg%20transform=&#x27;translate(14,%2030)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%2310b981&#x27;%20stroke=&#x27;%2334d399&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Bottom-right%20worker%20--%3e%3cg%20transform=&#x27;translate(34,%2030)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%238b5cf6&#x27;%20stroke=&#x27;%23a78bfa&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Communication%20channels%20(dashed%20lines%20showing%20IPC)%20--%3e%3cline%20x1=&#x27;24&#x27;%20y1=&#x27;16&#x27;%20x2=&#x27;14&#x27;%20y2=&#x27;26&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3cline%20x1=&#x27;24&#x27;%20y1=&#x27;16&#x27;%20x2=&#x27;34&#x27;%20y2=&#x27;26&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3cline%20x1=&#x27;20&#x27;%20y1=&#x27;30&#x27;%20x2=&#x27;28&#x27;%20y2=&#x27;30&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3c!--%20Type-safe%20data%20packets%20on%20channels%20--%3e%3ccircle%20cx=&#x27;19&#x27;%20cy=&#x27;21&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3ccircle%20cx=&#x27;29&#x27;%20cy=&#x27;21&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3ccircle%20cx=&#x27;24&#x27;%20cy=&#x27;30&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3c/svg%3e"/><meta name="theme-color" content="#131316"/><meta property="og:type" content="website"/><meta property="og:title" content="isolated-workers"/><meta property="og:description" content="Type-safe worker processes with end-to-end message contracts"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="isolated-workers"/><meta name="twitter:description" content="Type-safe worker processes with end-to-end message contracts"/>
    
    <meta name="description" content="Type-safe worker processes with end-to-end message contracts" /><meta property="og:description" content="Type-safe worker processes with end-to-end message contracts" />
    
  
        
      </head>
      <body>
        
        <div id="root"><div class="min-h-screen bg-primary text-gray-100"><div class="fixed inset-0 overflow-hidden pointer-events-none " aria-hidden="true"><div class="absolute inset-0 retro-horizon"></div><div class="absolute inset-0 retro-grid"></div><div class="absolute w-96 h-96 rounded-full blur-3xl animate-float" style="top:15%;left:20%;background:radial-gradient(circle, rgba(0, 240, 255, 0.15) 0%, transparent 70%)"></div><div class="absolute w-96 h-96 rounded-full blur-3xl animate-float" style="bottom:20%;right:15%;background:radial-gradient(circle, rgba(191, 0, 255, 0.12) 0%, transparent 70%);animation-delay:2s"></div><div class="absolute w-72 h-72 rounded-full blur-3xl animate-float" style="top:40%;left:50%;transform:translateX(-50%);background:radial-gradient(circle, rgba(255, 0, 128, 0.08) 0%, transparent 70%);animation-delay:4s"></div><div class="absolute w-64 h-64 rounded-full blur-3xl animate-pulse-slow" style="top:10%;right:25%;background:radial-gradient(circle, rgba(0, 255, 157, 0.06) 0%, transparent 70%);animation-delay:1s"></div><div class="absolute inset-0 retro-scanlines"></div></div><header class="fixed top-0 left-0 right-0 h-20 z-50 glass-enhanced border-b border-neon-cyan/10"><div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-between"><a href="/isolated-workers/" class="flex items-center gap-3 group"><div class="relative neon-flicker-slow"><img src="data:image/svg+xml,%3csvg%20width=&#x27;48&#x27;%20height=&#x27;48&#x27;%20viewBox=&#x27;0%200%2048%2048&#x27;%20fill=&#x27;none&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3e%3c!--%20Background%20hexagon%20representing%20the%20isolated%20container%20--%3e%3cpath%20d=&#x27;M24%204L42%2014V34L24%2044L6%2034V14L24%204Z&#x27;%20fill=&#x27;%231a1a2e&#x27;%20stroke=&#x27;%234a5568&#x27;%20stroke-width=&#x27;1.5&#x27;/%3e%3c!--%20Inner%20isolated%20worker%20cells%20--%3e%3c!--%20Top%20worker%20--%3e%3cg%20transform=&#x27;translate(24,%2012)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%233b82f6&#x27;%20stroke=&#x27;%2360a5fa&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Bottom-left%20worker%20--%3e%3cg%20transform=&#x27;translate(14,%2030)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%2310b981&#x27;%20stroke=&#x27;%2334d399&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Bottom-right%20worker%20--%3e%3cg%20transform=&#x27;translate(34,%2030)&#x27;%3e%3crect%20x=&#x27;-6&#x27;%20y=&#x27;-4&#x27;%20width=&#x27;12&#x27;%20height=&#x27;8&#x27;%20rx=&#x27;2&#x27;%20fill=&#x27;%238b5cf6&#x27;%20stroke=&#x27;%23a78bfa&#x27;%20stroke-width=&#x27;1&#x27;/%3e%3ccircle%20cx=&#x27;0&#x27;%20cy=&#x27;0&#x27;%20r=&#x27;2&#x27;%20fill=&#x27;%23fff&#x27;/%3e%3c/g%3e%3c!--%20Communication%20channels%20(dashed%20lines%20showing%20IPC)%20--%3e%3cline%20x1=&#x27;24&#x27;%20y1=&#x27;16&#x27;%20x2=&#x27;14&#x27;%20y2=&#x27;26&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3cline%20x1=&#x27;24&#x27;%20y1=&#x27;16&#x27;%20x2=&#x27;34&#x27;%20y2=&#x27;26&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3cline%20x1=&#x27;20&#x27;%20y1=&#x27;30&#x27;%20x2=&#x27;28&#x27;%20y2=&#x27;30&#x27;%20stroke=&#x27;%236b7280&#x27;%20stroke-width=&#x27;1.5&#x27;%20stroke-dasharray=&#x27;2,2&#x27;/%3e%3c!--%20Type-safe%20data%20packets%20on%20channels%20--%3e%3ccircle%20cx=&#x27;19&#x27;%20cy=&#x27;21&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3ccircle%20cx=&#x27;29&#x27;%20cy=&#x27;21&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3ccircle%20cx=&#x27;24&#x27;%20cy=&#x27;30&#x27;%20r=&#x27;1.5&#x27;%20fill=&#x27;%23fbbf24&#x27;/%3e%3c/svg%3e" height="40" width="40" alt="isolated-workers logo" class="transition-all duration-300 group-hover:drop-shadow-[0_0_12px_rgba(0,240,255,0.6)]"/></div><span class="text-xl font-bold bg-linear-to-r from-neon-cyan to-neon-purple bg-clip-text text-transparent neon-flicker-alt neon-flicker-delay-1">isolated-workers</span></a><nav class="hidden md:flex items-center gap-6"><a href="/isolated-workers/docs/getting-started" class="
        text-sm font-medium transition-all duration-200 relative link-underline
        text-gray-400 hover:text-gray-200
      ">Getting Started</a><a href="/isolated-workers/docs/guides" class="
        text-sm font-medium transition-all duration-200 relative link-underline
        text-neon-cyan text-glow-cyan
      ">Guides<span class="absolute -bottom-1 left-0 right-0 h-0.5 bg-linear-to-r from-neon-cyan to-neon-purple shadow-neon-sm"></span></a><a href="/isolated-workers/examples" class="
        text-sm font-medium transition-all duration-200 relative link-underline
        text-gray-400 hover:text-gray-200
      ">Examples</a><a href="/isolated-workers/api" class="
        text-sm font-medium transition-all duration-200 relative link-underline
        text-gray-400 hover:text-gray-200
      ">API Reference</a></nav><div class="hidden md:block"><div class="relative"><div class="relative"><svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><input type="text" placeholder="Search docs..." class="
            w-64 pl-10 pr-16 py-2 rounded-lg text-sm
            bg-black/40 border border-white/10
            text-gray-100 placeholder:text-gray-500
            focus:border-neon-cyan focus:ring-1 focus:ring-neon-cyan/50
            focus:outline-none transition-all duration-200
            hover:border-white/20
          " value=""/><kbd class="absolute right-3 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-xs bg-white/5 border border-white/10 rounded text-gray-500 pointer-events-none flex items-center gap-0.5"><span class="text-[10px]">âŒ˜</span>K</kbd></div></div></div></div></header><div class="pt-20"><div class="relative flex min-h-[calc(100vh-5rem)] p-4 lg:max-w-9/12 m-auto gap-4"><aside class="hidden lg:block shrink-0 p-4 sticky top-0 self-start w-72 rounded-2xl glass-enhanced border-glow"><div class="h-[calc(100vh-6rem)] overflow-y-auto"><nav class="p-4 h-full overflow-y-auto space-y-6"><div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/getting-started" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Getting Started</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/getting-started/installation" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Installation</a></li><li><a href="/isolated-workers/docs/getting-started/quick-start" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Quick Start</a></li><li><a href="/isolated-workers/docs/getting-started/first-worker" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Building Your First Worker</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/concepts" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Concepts</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/concepts/why-isolated-workers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Why isolated-workers?</a></li><li><a href="/isolated-workers/docs/concepts/drivers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Drivers</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/guides" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Guides</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/guides/error-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Error Handling</a></li><li><a href="/isolated-workers/docs/guides/middleware" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Middleware</a></li><li><a href="/isolated-workers/docs/guides/timeout-configuration" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Timeout Configuration</a></li><li><a href="/isolated-workers/docs/guides/custom-serializers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Custom Serializers</a></li><li><a href="/isolated-workers/docs/guides/worker-lifecycle" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Lifecycle</a></li><li><a href="/isolated-workers/docs/guides/typescript" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">TypeScript Deep Dive</a></li><li><a href="/isolated-workers/docs/guides/troubleshooting" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Troubleshooting</a></li><li><a href="/isolated-workers/docs/guides/testing" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        bg-neon-cyan/10 text-neon-cyan border-l-2 border-neon-cyan shadow-neon-sm active-pulse
      ">Testing Workers</a></li><li><a href="/isolated-workers/docs/guides/security" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Security Considerations</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/examples" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Examples</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/examples/basic-ping" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Basic Ping-Pong Worker</a></li><li><a href="/isolated-workers/examples/custom-serializer" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Custom Serializer</a></li><li><a href="/isolated-workers/examples/error-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Error Handling</a></li><li><a href="/isolated-workers/examples/middleware" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Middleware Pipeline</a></li><li><a href="/isolated-workers/examples/timeout-config" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Timeout Configuration</a></li><li><a href="/isolated-workers/examples/shutdown-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Unexpected Worker Shutdown Handling</a></li><li><a href="/isolated-workers/examples/worker-lifecycle" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Lifecycle Management</a></li><li><a href="/isolated-workers/examples/worker-threads-driver" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Threads Driver</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/api" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">API Reference</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/api#configuration" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Configuration</a></li><li><a href="/isolated-workers/api#core" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Core</a></li><li><a href="/isolated-workers/api#drivers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Drivers</a></li><li><a href="/isolated-workers/api#other" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Other</a></li><li><a href="/isolated-workers/api#serialization" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Serialization</a></li><li><a href="/isolated-workers/api#types" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Types</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><span class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2">Configuration</span><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/guides/shutdown-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Shutdown Handling</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><span class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2">Resources</span><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/faq" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">FAQ</a></li><li><a href="/isolated-workers/docs/contributing" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Contributing</a></li></ul></div></nav></div></aside><aside class="
                  lg:hidden left-4 bottom-4 top-24 w-72
                  glass-enhanced border-glow fixed! rounded-2xl
                  z-40 transition-transform duration-300 ease-in-out
                  -translate-x-full
                  overflow-clip
                "><div class="h-[calc(100vh-5rem)] overflow-y-auto"><nav class="p-4 h-full overflow-y-auto space-y-6"><div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/getting-started" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Getting Started</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/getting-started/installation" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Installation</a></li><li><a href="/isolated-workers/docs/getting-started/quick-start" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Quick Start</a></li><li><a href="/isolated-workers/docs/getting-started/first-worker" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Building Your First Worker</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/concepts" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Concepts</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/concepts/why-isolated-workers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Why isolated-workers?</a></li><li><a href="/isolated-workers/docs/concepts/drivers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Drivers</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/docs/guides" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Guides</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/guides/error-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Error Handling</a></li><li><a href="/isolated-workers/docs/guides/middleware" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Middleware</a></li><li><a href="/isolated-workers/docs/guides/timeout-configuration" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Timeout Configuration</a></li><li><a href="/isolated-workers/docs/guides/custom-serializers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Custom Serializers</a></li><li><a href="/isolated-workers/docs/guides/worker-lifecycle" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Lifecycle</a></li><li><a href="/isolated-workers/docs/guides/typescript" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">TypeScript Deep Dive</a></li><li><a href="/isolated-workers/docs/guides/troubleshooting" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Troubleshooting</a></li><li><a href="/isolated-workers/docs/guides/testing" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        bg-neon-cyan/10 text-neon-cyan border-l-2 border-neon-cyan shadow-neon-sm active-pulse
      ">Testing Workers</a></li><li><a href="/isolated-workers/docs/guides/security" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Security Considerations</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/examples" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">Examples</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/examples/basic-ping" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Basic Ping-Pong Worker</a></li><li><a href="/isolated-workers/examples/custom-serializer" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Custom Serializer</a></li><li><a href="/isolated-workers/examples/error-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Error Handling</a></li><li><a href="/isolated-workers/examples/middleware" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Middleware Pipeline</a></li><li><a href="/isolated-workers/examples/timeout-config" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Timeout Configuration</a></li><li><a href="/isolated-workers/examples/shutdown-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Unexpected Worker Shutdown Handling</a></li><li><a href="/isolated-workers/examples/worker-lifecycle" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Lifecycle Management</a></li><li><a href="/isolated-workers/examples/worker-threads-driver" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Worker Threads Driver</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><a href="/isolated-workers/api" class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2 hover:text-neon-cyan transition-colors duration-200">API Reference</a><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/api#configuration" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Configuration</a></li><li><a href="/isolated-workers/api#core" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Core</a></li><li><a href="/isolated-workers/api#drivers" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Drivers</a></li><li><a href="/isolated-workers/api#other" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Other</a></li><li><a href="/isolated-workers/api#serialization" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Serialization</a></li><li><a href="/isolated-workers/api#types" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Types</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><span class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2">Configuration</span><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/guides/shutdown-handling" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Shutdown Handling</a></li></ul></div><div><div class="divider-glow mb-4"></div><div class="flex items-center justify-between mb-2 px-3"><span class="text-xs font-semibold text-gray-500 uppercase tracking-wider neon-flicker-slow neon-flicker-delay-2">Resources</span><button class="shrink-0 ml-2 hover:text-neon-cyan transition-colors"><svg class="w-4 h-4 transition-transform duration-200 " fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div><ul class="space-y-1 list-none"><li><a href="/isolated-workers/docs/faq" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">FAQ</a></li><li><a href="/isolated-workers/docs/contributing" class="
        block px-3 py-2 rounded-lg text-sm transition-all duration-200
        text-gray-400 hover:text-gray-200 hover:bg-tertiary/30 hover:border-l-2 hover:border-neon-cyan/30
      ">Contributing</a></li></ul></div></nav></div></aside><main class="flex-1 min-w-0 py-4"><div class="max-w-4xl rounded-2xl bg-secondary/60 backdrop-blur-sm border border-tertiary/30 px-8 py-8"><div><div class="flex items-center gap-2 text-sm text-gray-400 mb-6"><a href="/isolated-workers/" class="hover:text-neon-cyan">Home</a><span>/</span><span class="text-gray-100">Testing Workers</span></div><div class="prose prose-invert max-w-none space-y-8"><div class="docs-prose"><h1>Testing Workers</h1>
<p>Testing worker-based code requires different strategies depending on what you want to verify. This guide covers unit testing handlers in isolation, integration testing with real workers, and patterns for mocking workers in host-side tests.</p>
<h2>Testing Strategies Overview</h2>
<p>Worker-based applications have three natural testing layers:</p>





























<table><thead><tr><th>Layer</th><th>What to Test</th><th>Speed</th><th>Isolation</th></tr></thead><tbody><tr><td><strong>Unit</strong></td><td>Handler logic, message validation</td><td>Fast</td><td>High</td></tr><tr><td><strong>Integration</strong></td><td>Full IPC round-trips, serialization</td><td>Medium</td><td>Medium</td></tr><tr><td><strong>E2E</strong></td><td>Complete workflows, process lifecycle</td><td>Slow</td><td>Low</td></tr></tbody></table>
<h3>When to Use Each Strategy</h3>
<ul>
<li><strong>Unit tests</strong>: Business logic in handlers, validation, transformations</li>
<li><strong>Integration tests</strong>: IPC communication, serialization, timeouts, error propagation</li>
<li><strong>E2E tests</strong>: Full application workflows, deployment verification</li>
</ul>
<h2>Testing Handlers in Isolation</h2>
<p>The fastest and most reliable tests focus on handler functions directly, without spawning worker processes.</p>
<h3>Extract Handler Logic</h3>
<p>Structure your workers to make handlers easily testable:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// handlers.ts - Testable handler logic</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#F97583"> type</span><span style="color:#E1E4E8"> { <a href="/isolated-workers/api/handlers" class="code-link" title="View Handlers documentation">Handlers</a> } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'isolated-workers'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#F97583"> type</span><span style="color:#E1E4E8"> { Messages } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './messages.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> createHandlers</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">deps</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> { </span><span style="color:#FFAB70">db</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Database</span><span style="color:#E1E4E8"> })</span><span style="color:#F97583">:</span><span style="color:#B392F0"> <a href="/isolated-workers/api/handlers" class="code-link" title="View Handlers documentation">Handlers</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">    getUser</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> ({ </span><span style="color:#FFAB70">userId</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> user</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> deps.db.</span><span style="color:#B392F0">findUser</span><span style="color:#E1E4E8">(userId);</span></span>
<span class="line"><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">user) {</span></span>
<span class="line"><span style="color:#F97583">        throw</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Error</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`User ${</span><span style="color:#E1E4E8">userId</span><span style="color:#9ECBFF">} not found`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#F97583">      return</span><span style="color:#E1E4E8"> { user };</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    createUser</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> ({ </span><span style="color:#FFAB70">name</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">email</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> id</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> deps.db.</span><span style="color:#B392F0">createUser</span><span style="color:#E1E4E8">({ name, email });</span></span>
<span class="line"><span style="color:#F97583">      return</span><span style="color:#E1E4E8"> { id };</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#E1E4E8">  };</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre></div></div></div></div></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// worker.ts - Thin wrapper that starts the server</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { <a href="/isolated-workers/api/start-worker-server" class="code-link" title="View startWorkerServer documentation">startWorkerServer</a> } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'isolated-workers'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { createHandlers } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './handlers.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { createDatabase } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './database.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> db</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> createDatabase</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> handlers</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> createHandlers</span><span style="color:#E1E4E8">({ db });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0"><a href="/isolated-workers/api/start-worker-server" class="code-link" title="View startWorkerServer documentation">startWorkerServer</a></span><span style="color:#E1E4E8">(handlers);</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Unit Testing Handlers</h3>
<p>Test handlers as regular async functions:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// handlers.spec.ts</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { createHandlers } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './handlers.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'User Handlers'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> mockDb</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    findUser: jest.</span><span style="color:#B392F0">fn</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">    createUser: jest.</span><span style="color:#B392F0">fn</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> handlers</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> createHandlers</span><span style="color:#E1E4E8">({ db: mockDb });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  beforeEach</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    jest.</span><span style="color:#B392F0">clearAllMocks</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'getUser'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">    it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'returns user when found'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> user</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> { id: </span><span style="color:#9ECBFF">'123'</span><span style="color:#E1E4E8">, name: </span><span style="color:#9ECBFF">'Alice'</span><span style="color:#E1E4E8"> };</span></span>
<span class="line"><span style="color:#E1E4E8">      mockDb.findUser.</span><span style="color:#B392F0">mockResolvedValue</span><span style="color:#E1E4E8">(user);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> result</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> handlers.</span><span style="color:#B392F0">getUser</span><span style="color:#E1E4E8">({ userId: </span><span style="color:#9ECBFF">'123'</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(result).</span><span style="color:#B392F0">toEqual</span><span style="color:#E1E4E8">({ user });</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(mockDb.findUser).</span><span style="color:#B392F0">toHaveBeenCalledWith</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'123'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'throws when user not found'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">      mockDb.findUser.</span><span style="color:#B392F0">mockResolvedValue</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#B392F0"> expect</span><span style="color:#E1E4E8">(handlers.</span><span style="color:#B392F0">getUser</span><span style="color:#E1E4E8">({ userId: </span><span style="color:#9ECBFF">'unknown'</span><span style="color:#E1E4E8"> })).rejects.</span><span style="color:#B392F0">toThrow</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#9ECBFF">        'User unknown not found'</span></span>
<span class="line"><span style="color:#E1E4E8">      );</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"><span style="color:#E1E4E8">  </span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h2>Test File Organization</h2>
<p>Organize your test files by layer to maintain clarity and enable selective test execution:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">markdown</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">src/</span></span>
<span class="line"><span style="color:#E1E4E8">â”œâ”€â”€ handlers/</span></span>
<span class="line"><span style="color:#E1E4E8">â”‚ â””â”€â”€ calculator.spec.ts # Unit tests - handler logic only</span></span>
<span class="line"><span style="color:#E1E4E8">â”œâ”€â”€ worker.ts</span></span>
<span class="line"><span style="color:#E1E4E8">â””â”€â”€ worker.integration.spec.ts # Integration tests - full IPC round-trips</span></span>
<span class="line"><span style="color:#E1E4E8">tests/</span></span>
<span class="line"><span style="color:#E1E4E8">â”œâ”€â”€ e2e/</span></span>
<span class="line"><span style="color:#E1E4E8">â”‚ â””â”€â”€ workflow.spec.ts # E2E tests - complete application flows</span></span>
<span class="line"><span style="color:#E1E4E8">â””â”€â”€ test-utils/</span></span>
<span class="line"><span style="color:#E1E4E8">â”œâ”€â”€ mock-worker.ts</span></span>
<span class="line"><span style="color:#E1E4E8">â””â”€â”€ ci-config.ts</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><p><strong>Naming Conventions</strong>:</p>
<ul>
<li><code class="inline-code">*.spec.ts</code> or <code class="inline-code">*.test.ts</code> - Unit tests for individual functions/modules</li>
<li><code class="inline-code">*.integration.spec.ts</code> - Integration tests with real workers and IPC</li>
<li><code class="inline-code">e2e/*.spec.ts</code> - End-to-end tests of complete workflows</li>
</ul>
<p><strong>Package.json Scripts</strong>:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">json</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#79B8FF">  "scripts"</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#79B8FF">    "test"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"jest"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    "test:unit"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"jest --testPathIgnorePatterns='integration'"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    "test:integration"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"jest --testPathPattern='integration'"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    "test:e2e"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"jest --config=jest.e2e.config.js"</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><p>This organization allows:</p>
<ul>
<li>Fast feedback from unit tests during development</li>
<li>Separate integration test runs when needed</li>
<li>E2E tests only during CI/CD or before releases</li>
<li>Clear separation of concerns in test suites</li>
</ul>
<h2>Async Testing Patterns</h2>
<h3>Handling Timeouts</h3>
<p>Test timeout behavior explicitly:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Timeout Handling'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'times out slow operations'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">      timeout: {</span></span>
<span class="line"><span style="color:#E1E4E8">        WORKER_MESSAGE: </span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// Very short timeout for testing</span></span>
<span class="line"><span style="color:#E1E4E8">      },</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#B392F0"> expect</span><span style="color:#E1E4E8">(worker.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'slowOperation'</span><span style="color:#E1E4E8">, {})).rejects.</span><span style="color:#B392F0">toThrow</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#9ECBFF">        /</span><span style="color:#DBEDFF">timeout</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span></span>
<span class="line"><span style="color:#E1E4E8">      );</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">finally</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'completes within timeout'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">      timeout: {</span></span>
<span class="line"><span style="color:#E1E4E8">        fastOperation: </span><span style="color:#79B8FF">5000</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">      },</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> result</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'fastOperation'</span><span style="color:#E1E4E8">, {});</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(result).</span><span style="color:#B392F0">toBeDefined</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">finally</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Proper Cleanup with finally</h3>
<p>Always clean up workers, even when tests fail:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Resource Cleanup'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'cleans up on success'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> result</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'compute'</span><span style="color:#E1E4E8">, { data: </span><span style="color:#79B8FF">42</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(result.value).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">84</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">finally</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(worker.isActive).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'cleans up on failure'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'fail'</span><span style="color:#E1E4E8">, {});</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">catch</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">      // Expected error</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">finally</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(worker.isActive).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Testing Worker Lifecycle Events</h3></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Lifecycle Events'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'detects worker shutdown'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(worker.isActive).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(worker.isConnected).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(worker.isActive).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(worker.isConnected).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'rejects messages after close'</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    await</span><span style="color:#E1E4E8"> worker.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    await</span><span style="color:#B392F0"> expect</span><span style="color:#E1E4E8">(worker.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'ping'</span><span style="color:#E1E4E8">, {})).rejects.</span><span style="color:#B392F0">toThrow</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">/</span><span style="color:#DBEDFF">not active</span><span style="color:#9ECBFF">/</span><span style="color:#F97583">i</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h2>CI Considerations</h2>
<h3>GitHub Actions Example</h3></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">yaml</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D"># .github/workflows/test.yml</span></span>
<span class="line"><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Tests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">on</span><span style="color:#E1E4E8">: [</span><span style="color:#9ECBFF">push</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">pull_request</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">jobs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  test</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    runs-on</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">ubuntu-latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">    steps</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">uses</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">actions/checkout@v4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Setup Node.js</span></span>
<span class="line"><span style="color:#85E89D">        uses</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">actions/setup-node@v4</span></span>
<span class="line"><span style="color:#85E89D">        with</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          node-version</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'20'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Install dependencies</span></span>
<span class="line"><span style="color:#85E89D">        run</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">npm ci</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Build worker scripts</span></span>
<span class="line"><span style="color:#85E89D">        run</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Run unit tests</span></span>
<span class="line"><span style="color:#85E89D">        run</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">npm test -- --testPathPattern='\\.spec\\.ts$'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Run integration tests</span></span>
<span class="line"><span style="color:#85E89D">        run</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">npm test -- --testPathPattern='\\.integration\\.ts$'</span></span>
<span class="line"><span style="color:#85E89D">        timeout-minutes</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">10</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>CI-Specific Timeout Adjustments</h3>
<p>CI environments are often slower than local machines:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// test-utils/ci-config.ts</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#79B8FF"> isCI</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> process.env.</span><span style="color:#79B8FF">CI</span><span style="color:#F97583"> ===</span><span style="color:#9ECBFF"> 'true'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#79B8FF"> timeouts</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  workerStartup: isCI </span><span style="color:#F97583">?</span><span style="color:#79B8FF"> 20000</span><span style="color:#F97583"> :</span><span style="color:#79B8FF"> 10000</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  workerMessage: isCI </span><span style="color:#F97583">?</span><span style="color:#79B8FF"> 30000</span><span style="color:#F97583"> :</span><span style="color:#79B8FF"> 10000</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  testTimeout: isCI </span><span style="color:#F97583">?</span><span style="color:#79B8FF"> 60000</span><span style="color:#F97583"> :</span><span style="color:#79B8FF"> 30000</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre></div></div></div></div></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// integration.spec.ts</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { timeouts } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './test-utils/ci-config.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Integration Tests'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  let</span><span style="color:#E1E4E8"> worker</span><span style="color:#F97583">:</span><span style="color:#B392F0"> <a href="/isolated-workers/api/worker-client" class="code-link" title="View WorkerClient documentation">WorkerClient</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  beforeAll</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    worker </span><span style="color:#F97583">=</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">      script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">      timeout: {</span></span>
<span class="line"><span style="color:#E1E4E8">        WORKER_STARTUP: timeouts.workerStartup,</span></span>
<span class="line"><span style="color:#E1E4E8">        WORKER_MESSAGE: timeouts.workerMessage,</span></span>
<span class="line"><span style="color:#E1E4E8">      },</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">  }, timeouts.testTimeout);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">  // ...tests</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Avoiding Port/Socket Conflicts</h3>
<p>Run integration tests sequentially to avoid socket conflicts:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">javascript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// jest.config.js</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">  // Run test files sequentially</span></span>
<span class="line"><span style="color:#E1E4E8">  maxWorkers: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">  // Or use runInBand for complete isolation</span></span>
<span class="line"><span style="color:#6A737D">  // runInBand: true,</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Debugging Failed CI Tests</h3>
<p>Enable debug logging in CI for troubleshooting:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> worker</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> <a href="/isolated-workers/api/create-worker" class="code-link" title="View createWorker documentation">createWorker</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">>({</span></span>
<span class="line"><span style="color:#E1E4E8">  script: </span><span style="color:#9ECBFF">'./dist/worker.js'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  logLevel: process.env.</span><span style="color:#79B8FF">CI</span><span style="color:#F97583"> ?</span><span style="color:#9ECBFF"> 'debug'</span><span style="color:#F97583"> :</span><span style="color:#9ECBFF"> 'error'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h2>Best Practices Summary</h2>
<ol>
<li><strong>Unit test handlers directly</strong> - Extract handler logic into testable functions</li>
<li><strong>Use dependency injection</strong> - Pass dependencies to handlers for easy mocking</li>
<li><strong>Mock workers for host tests</strong> - Avoid process overhead when testing host code</li>
<li><strong>Clean up workers in finally blocks</strong> - Prevent orphaned processes</li>
<li><strong>Adjust timeouts for CI</strong> - CI environments are slower than local machines</li>
<li><strong>Run integration tests sequentially</strong> - Avoid socket conflicts</li>
<li><strong>Separate unit and integration tests</strong> - Run fast tests frequently, slow tests less often</li>
</ol>
<h3>Custom Transaction ID Generator Testing</h3>
<p>When testing code that uses custom transaction ID generators, ensure your generator produces unique IDs:</p></div><div class="relative group my-6"><div class="
          rounded-lg overflow-hidden border border-white/10 bg-tertiary/80
          transition-all duration-300 border-glow
          shadow-neon-sm
        "><div class="px-4 py-3 bg-black/50 border-b border-white/5 flex items-center justify-between"><div class="flex items-center gap-3"><div class="flex gap-2"><span class="w-3 h-3 rounded-full bg-[#ff5f56] shadow-[0_0_6px_rgba(255,95,86,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#ffbd2e] shadow-[0_0_6px_rgba(255,189,46,0.4)]"></span><span class="w-3 h-3 rounded-full bg-[#27ca40] shadow-[0_0_6px_rgba(39,202,64,0.4)]"></span></div><span class="text-xs text-gray-500 font-mono">typescript</span></div><button class="
              text-xs flex items-center gap-1.5 px-2 py-1 rounded
              transition-all duration-200
              text-neon-cyan hover:text-neon-mint hover:bg-neon-cyan/10
            " title="Copy code"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>Copy</button></div><div class="overflow-x-auto bg-black/60"><div class="p-4 [&amp;_pre]:bg-transparent [&amp;_code]:bg-transparent"><div class="text-sm [&amp;_pre]:m-0 [&amp;_code]:m-0"><pre class="shiki github-dark" style="background-color:#00000000;color:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#6A737D">// custom-tx-generator.ts</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#B392F0"> customTxIdGenerator</span><span style="color:#F97583">:</span><span style="color:#B392F0"> <a href="/isolated-workers/api/transaction-id-generator" class="code-link" title="View TransactionIdGenerator documentation">TransactionIdGenerator</a></span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">Messages</span><span style="color:#E1E4E8">> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#FFAB70">  message</span></span>
<span class="line"><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#9ECBFF"> `${</span><span style="color:#E1E4E8">message</span><span style="color:#9ECBFF">.</span><span style="color:#E1E4E8">type</span><span style="color:#9ECBFF">}-${</span><span style="color:#E1E4E8">Date</span><span style="color:#9ECBFF">.</span><span style="color:#B392F0">now</span><span style="color:#9ECBFF">()</span><span style="color:#9ECBFF">}-${</span><span style="color:#E1E4E8">Math</span><span style="color:#9ECBFF">.</span><span style="color:#B392F0">random</span><span style="color:#9ECBFF">()</span></span>
<span class="line"><span style="color:#9ECBFF">    .</span><span style="color:#B392F0">toString</span><span style="color:#9ECBFF">(</span><span style="color:#79B8FF">36</span><span style="color:#9ECBFF">)</span></span>
<span class="line"><span style="color:#9ECBFF">    .</span><span style="color:#B392F0">substr</span><span style="color:#9ECBFF">(</span><span style="color:#79B8FF">2</span><span style="color:#9ECBFF">, </span><span style="color:#79B8FF">9</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">}`</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// custom-tx-generator.spec.ts</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { customTxIdGenerator } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './custom-tx-generator'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Custom Transaction ID Generator'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'generates unique IDs for different calls'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> id1</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> customTxIdGenerator</span><span style="color:#E1E4E8">({ type: </span><span style="color:#9ECBFF">'test'</span><span style="color:#E1E4E8">, payload: {}, tx: </span><span style="color:#9ECBFF">'init'</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> id2</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> customTxIdGenerator</span><span style="color:#E1E4E8">({ type: </span><span style="color:#9ECBFF">'test'</span><span style="color:#E1E4E8">, payload: {}, tx: </span><span style="color:#9ECBFF">'init'</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(id1).not.</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(id2);</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'includes message type in ID'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> id</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> customTxIdGenerator</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">      type: </span><span style="color:#9ECBFF">'processImage'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">      payload: {},</span></span>
<span class="line"><span style="color:#E1E4E8">      tx: </span><span style="color:#9ECBFF">'init'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#B392F0">    expect</span><span style="color:#E1E4E8">(id).</span><span style="color:#B392F0">toContain</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'processImage'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'generates IDs compatible with transaction tracking'</span><span style="color:#E1E4E8">, () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> ids</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Set</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">>();</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 1000</span><span style="color:#E1E4E8">; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#79B8FF"> id</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> customTxIdGenerator</span><span style="color:#E1E4E8">({ type: </span><span style="color:#9ECBFF">'test'</span><span style="color:#E1E4E8">, payload: {}, tx: </span><span style="color:#9ECBFF">'init'</span><span style="color:#E1E4E8"> });</span></span>
<span class="line"><span style="color:#B392F0">      expect</span><span style="color:#E1E4E8">(ids.</span><span style="color:#B392F0">has</span><span style="color:#E1E4E8">(id)).</span><span style="color:#B392F0">toBe</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">      ids.</span><span style="color:#B392F0">add</span><span style="color:#E1E4E8">(id);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre></div></div></div></div></div><div class="docs-prose"><h3>Mock Worker Limitations</h3>
<p>When using mock workers for testing, be aware that:</p>
<ul>
<li><strong>Mock workers bypass driver capability constraints</strong> - They don't enforce driver-specific features or limitations</li>
<li>No actual serialization/deserialization occurs</li>
<li>Network/IO latency is not simulated</li>
<li>Real process lifecycle events are not tested</li>
<li>Socket/file cleanup is not verified</li>
</ul>
<p>Use real workers in integration tests to verify driver-specific behavior, especially when:</p>
<ul>
<li>Testing serialization formats or custom serializers</li>
<li>Verifying timeout handling across process boundaries</li>
<li>Validating error propagation through actual IPC</li>
<li>Testing resource limits or worker crashes</li>
</ul>
<h2>See Also</h2>
<ul>
<li><a href="/isolated-workers/docs/guides/error-handling">Error Handling</a> - Testing error propagation</li>
<li><a href="/isolated-workers/docs/guides/worker-lifecycle">Worker Lifecycle</a> - Testing lifecycle events</li>
<li><a href="/isolated-workers/docs/guides/timeout-configuration">Timeout Configuration</a> - Configuring test timeouts</li>
</ul></div></div><div class="mt-12 pt-8 border-t border-tertiary/50"><a href="/isolated-workers/" class="text-neon-cyan hover:text-neon-purple transition-colors">â† Back to Home</a></div></div></div></main></div></div><div class="fixed bottom-4 right-4 z-50"><div class="relative "><button class="p-2 rounded-lg bg-tertiary/50 border border-tertiary hover:border-neon-cyan/50 transition-colors" title="Toggle visual effects" aria-label="Toggle visual effects menu"><svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path></svg></button></div></div></div></div>
        
        <script id="vike_pageContext" type="application/json">{"pageId":"\\/pages\\/docs","routeParams":{"splat":"guides\\/testing"},"data":{"doc":{"path":"\\/docs\\/guides\\/testing","filePath":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/docs\\/guides\\/testing.md","title":"Testing Workers","description":"Strategies for testing worker-based code","nav":{"section":"Guides","order":8}},"segments":[{"type":"html","html":"\u003ch1>Testing Workers\u003c\\/h1>\n\u003cp>Testing worker-based code requires different strategies depending on what you want to verify. This guide covers unit testing handlers in isolation, integration testing with real workers, and patterns for mocking workers in host-side tests.\u003c\\/p>\n\u003ch2>Testing Strategies Overview\u003c\\/h2>\n\u003cp>Worker-based applications have three natural testing layers:\u003c\\/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable>\u003cthead>\u003ctr>\u003cth>Layer\u003c\\/th>\u003cth>What to Test\u003c\\/th>\u003cth>Speed\u003c\\/th>\u003cth>Isolation\u003c\\/th>\u003c\\/tr>\u003c\\/thead>\u003ctbody>\u003ctr>\u003ctd>\u003cstrong>Unit\u003c\\/strong>\u003c\\/td>\u003ctd>Handler logic, message validation\u003c\\/td>\u003ctd>Fast\u003c\\/td>\u003ctd>High\u003c\\/td>\u003c\\/tr>\u003ctr>\u003ctd>\u003cstrong>Integration\u003c\\/strong>\u003c\\/td>\u003ctd>Full IPC round-trips, serialization\u003c\\/td>\u003ctd>Medium\u003c\\/td>\u003ctd>Medium\u003c\\/td>\u003c\\/tr>\u003ctr>\u003ctd>\u003cstrong>E2E\u003c\\/strong>\u003c\\/td>\u003ctd>Complete workflows, process lifecycle\u003c\\/td>\u003ctd>Slow\u003c\\/td>\u003ctd>Low\u003c\\/td>\u003c\\/tr>\u003c\\/tbody>\u003c\\/table>\n\u003ch3>When to Use Each Strategy\u003c\\/h3>\n\u003cul>\n\u003cli>\u003cstrong>Unit tests\u003c\\/strong>: Business logic in handlers, validation, transformations\u003c\\/li>\n\u003cli>\u003cstrong>Integration tests\u003c\\/strong>: IPC communication, serialization, timeouts, error propagation\u003c\\/li>\n\u003cli>\u003cstrong>E2E tests\u003c\\/strong>: Full application workflows, deployment verification\u003c\\/li>\n\u003c\\/ul>\n\u003ch2>Testing Handlers in Isolation\u003c\\/h2>\n\u003cp>The fastest and most reliable tests focus on handler functions directly, without spawning worker processes.\u003c\\/p>\n\u003ch3>Extract Handler Logic\u003c\\/h3>\n\u003cp>Structure your workers to make handlers easily testable:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"\\/\\/ handlers.ts - Testable handler logic\nimport type { Handlers } from 'isolated-workers';\nimport type { Messages } from '.\\/messages.js';\n\nexport function createHandlers(deps: { db: Database }): Handlers\u003cMessages> {\n  return {\n    getUser: async ({ userId }) => {\n      const user = await deps.db.findUser(userId);\n      if (!user) {\n        throw new Error(`User ${userId} not found`);\n      }\n      return { user };\n    },\n\n    createUser: async ({ name, email }) => {\n      const id = await deps.db.createUser({ name, email });\n      return { id };\n    },\n  };\n}","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ handlers.ts - Testable handler logic\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#F97583\"> type\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { \u003ca href=\"\\/isolated-workers\\/api\\/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers\u003c\\/a> } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> 'isolated-workers'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#F97583\"> type\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { Messages } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/messages.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">export\u003c\\/span>\u003cspan style=\"color:#F97583\"> function\u003c\\/span>\u003cspan style=\"color:#B392F0\"> createHandlers\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#FFAB70\">deps\u003c\\/span>\u003cspan style=\"color:#F97583\">:\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { \u003c\\/span>\u003cspan style=\"color:#FFAB70\">db\u003c\\/span>\u003cspan style=\"color:#F97583\">:\u003c\\/span>\u003cspan style=\"color:#B392F0\"> Database\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> })\u003c\\/span>\u003cspan style=\"color:#F97583\">:\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/handlers\" class=\"code-link\" title=\"View Handlers documentation\">Handlers\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">  return\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    getUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> ({ \u003c\\/span>\u003cspan style=\"color:#FFAB70\">userId\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> }) \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> user\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> deps.db.\u003c\\/span>\u003cspan style=\"color:#B392F0\">findUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(userId);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      if\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> (\u003c\\/span>\u003cspan style=\"color:#F97583\">!\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">user) {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">        throw\u003c\\/span>\u003cspan style=\"color:#F97583\"> new\u003c\\/span>\u003cspan style=\"color:#B392F0\"> Error\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">`User ${\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">userId\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">} not found`\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      return\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { user };\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    },\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    createUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> ({ \u003c\\/span>\u003cspan style=\"color:#FFAB70\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#FFAB70\">email\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> }) \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> id\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> deps.db.\u003c\\/span>\u003cspan style=\"color:#B392F0\">createUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ name, email });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      return\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { id };\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    },\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  };\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">}\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"code-block","language":"typescript","content":"\\/\\/ worker.ts - Thin wrapper that starts the server\nimport { startWorkerServer } from 'isolated-workers';\nimport { createHandlers } from '.\\/handlers.js';\nimport { createDatabase } from '.\\/database.js';\n\nconst db = createDatabase();\nconst handlers = createHandlers({ db });\n\nstartWorkerServer(handlers);","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ worker.ts - Thin wrapper that starts the server\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { \u003ca href=\"\\/isolated-workers\\/api\\/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer\u003c\\/a> } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> 'isolated-workers'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { createHandlers } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/handlers.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { createDatabase } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/database.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> db\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> createDatabase\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> handlers\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> createHandlers\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ db });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">\u003ca href=\"\\/isolated-workers\\/api\\/start-worker-server\" class=\"code-link\" title=\"View startWorkerServer documentation\">startWorkerServer\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(handlers);\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Unit Testing Handlers\u003c\\/h3>\n\u003cp>Test handlers as regular async functions:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"\\/\\/ handlers.spec.ts\nimport { createHandlers } from '.\\/handlers.js';\n\ndescribe('User Handlers', () => {\n  const mockDb = {\n    findUser: jest.fn(),\n    createUser: jest.fn(),\n  };\n\n  const handlers = createHandlers({ db: mockDb });\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('getUser', () => {\n    it('returns user when found', async () => {\n      const user = { id: '123', name: 'Alice' };\n      mockDb.findUser.mockResolvedValue(user);\n\n      const result = await handlers.getUser({ userId: '123' });\n\n      expect(result).toEqual({ user });\n      expect(mockDb.findUser).toHaveBeenCalledWith('123');\n    });\n\n    it('throws when user not found', async () => {\n      mockDb.findUser.mockResolvedValue(null);\n\n      await expect(handlers.getUser({ userId: 'unknown' })).rejects.toThrow(\n        'User unknown not found'\n      );\n  });\n});\n  ","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ handlers.spec.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { createHandlers } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/handlers.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'User Handlers'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">  const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> mockDb\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    findUser: jest.\u003c\\/span>\u003cspan style=\"color:#B392F0\">fn\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(),\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    createUser: jest.\u003c\\/span>\u003cspan style=\"color:#B392F0\">fn\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(),\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  };\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">  const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> handlers\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> createHandlers\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ db: mockDb });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  beforeEach\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(() \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    jest.\u003c\\/span>\u003cspan style=\"color:#B392F0\">clearAllMocks\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'getUser'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'returns user when found'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> user\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { id: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'123'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, name: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Alice'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> };\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      mockDb.findUser.\u003c\\/span>\u003cspan style=\"color:#B392F0\">mockResolvedValue\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(user);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> result\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> handlers.\u003c\\/span>\u003cspan style=\"color:#B392F0\">getUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ userId: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'123'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(result).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toEqual\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ user });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(mockDb.findUser).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toHaveBeenCalledWith\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'123'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'throws when user not found'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      mockDb.findUser.\u003c\\/span>\u003cspan style=\"color:#B392F0\">mockResolvedValue\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">null\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(handlers.\u003c\\/span>\u003cspan style=\"color:#B392F0\">getUser\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ userId: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'unknown'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> })).rejects.\u003c\\/span>\u003cspan style=\"color:#B392F0\">toThrow\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#9ECBFF\">        'User unknown not found'\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      );\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  \u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch2>Test File Organization\u003c\\/h2>\n\u003cp>Organize your test files by layer to maintain clarity and enable selective test execution:\u003c\\/p>"},{"type":"code-block","language":"markdown","content":"src\\/\nâ”œâ”€â”€ handlers\\/\nâ”‚ â””â”€â”€ calculator.spec.ts # Unit tests - handler logic only\nâ”œâ”€â”€ worker.ts\nâ””â”€â”€ worker.integration.spec.ts # Integration tests - full IPC round-trips\ntests\\/\nâ”œâ”€â”€ e2e\\/\nâ”‚ â””â”€â”€ workflow.spec.ts # E2E tests - complete application flows\nâ””â”€â”€ test-utils\\/\nâ”œâ”€â”€ mock-worker.ts\nâ””â”€â”€ ci-config.ts","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">src\\/\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”œâ”€â”€ handlers\\/\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”‚ â””â”€â”€ calculator.spec.ts # Unit tests - handler logic only\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”œâ”€â”€ worker.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â””â”€â”€ worker.integration.spec.ts # Integration tests - full IPC round-trips\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">tests\\/\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”œâ”€â”€ e2e\\/\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”‚ â””â”€â”€ workflow.spec.ts # E2E tests - complete application flows\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â””â”€â”€ test-utils\\/\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â”œâ”€â”€ mock-worker.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">â””â”€â”€ ci-config.ts\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003cp>\u003cstrong>Naming Conventions\u003c\\/strong>:\u003c\\/p>\n\u003cul>\n\u003cli>\u003ccode class=\"inline-code\">*.spec.ts\u003c\\/code> or \u003ccode class=\"inline-code\">*.test.ts\u003c\\/code> - Unit tests for individual functions\\/modules\u003c\\/li>\n\u003cli>\u003ccode class=\"inline-code\">*.integration.spec.ts\u003c\\/code> - Integration tests with real workers and IPC\u003c\\/li>\n\u003cli>\u003ccode class=\"inline-code\">e2e\\/*.spec.ts\u003c\\/code> - End-to-end tests of complete workflows\u003c\\/li>\n\u003c\\/ul>\n\u003cp>\u003cstrong>Package.json Scripts\u003c\\/strong>:\u003c\\/p>"},{"type":"code-block","language":"json","content":"{\n  \"scripts\": {\n    \"test\": \"jest\",\n    \"test:unit\": \"jest --testPathIgnorePatterns='integration'\",\n    \"test:integration\": \"jest --testPathPattern='integration'\",\n    \"test:e2e\": \"jest --config=jest.e2e.config.js\"\n  }\n}","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">{\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">  \"scripts\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">    \"test\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\"jest\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">    \"test:unit\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\"jest --testPathIgnorePatterns='integration'\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">    \"test:integration\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\"jest --testPathPattern='integration'\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">    \"test:e2e\"\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\"jest --config=jest.e2e.config.js\"\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">}\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003cp>This organization allows:\u003c\\/p>\n\u003cul>\n\u003cli>Fast feedback from unit tests during development\u003c\\/li>\n\u003cli>Separate integration test runs when needed\u003c\\/li>\n\u003cli>E2E tests only during CI\\/CD or before releases\u003c\\/li>\n\u003cli>Clear separation of concerns in test suites\u003c\\/li>\n\u003c\\/ul>\n\u003ch2>Async Testing Patterns\u003c\\/h2>\n\u003ch3>Handling Timeouts\u003c\\/h3>\n\u003cp>Test timeout behavior explicitly:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"describe('Timeout Handling', () => {\n  it('times out slow operations', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n      timeout: {\n        WORKER_MESSAGE: 100, \\/\\/ Very short timeout for testing\n      },\n    });\n\n    try {\n      await expect(worker.send('slowOperation', {})).rejects.toThrow(\n        \\/timeout\\/i\n      );\n    } finally {\n      await worker.close();\n    }\n  });\n\n  it('completes within timeout', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n      timeout: {\n        fastOperation: 5000,\n      },\n    });\n\n    try {\n      const result = await worker.send('fastOperation', {});\n      expect(result).toBeDefined();\n    } finally {\n      await worker.close();\n    }\n  });\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Timeout Handling'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'times out slow operations'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      timeout: {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">        WORKER_MESSAGE: \u003c\\/span>\u003cspan style=\"color:#79B8FF\">100\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#6A737D\">\\/\\/ Very short timeout for testing\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      },\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    try\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">send\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'slowOperation'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, {})).rejects.\u003c\\/span>\u003cspan style=\"color:#B392F0\">toThrow\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#9ECBFF\">        \\/\u003c\\/span>\u003cspan style=\"color:#DBEDFF\">timeout\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\\/\u003c\\/span>\u003cspan style=\"color:#F97583\">i\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      );\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    } \u003c\\/span>\u003cspan style=\"color:#F97583\">finally\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'completes within timeout'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      timeout: {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">        fastOperation: \u003c\\/span>\u003cspan style=\"color:#79B8FF\">5000\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      },\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    try\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> result\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">send\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'fastOperation'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, {});\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(result).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBeDefined\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    } \u003c\\/span>\u003cspan style=\"color:#F97583\">finally\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Proper Cleanup with finally\u003c\\/h3>\n\u003cp>Always clean up workers, even when tests fail:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"describe('Resource Cleanup', () => {\n  it('cleans up on success', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n    });\n\n    try {\n      const result = await worker.send('compute', { data: 42 });\n      expect(result.value).toBe(84);\n    } finally {\n      await worker.close();\n      expect(worker.isActive).toBe(false);\n    }\n  });\n\n  it('cleans up on failure', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n    });\n\n    try {\n      await worker.send('fail', {});\n    } catch {\n      \\/\\/ Expected error\n    } finally {\n      await worker.close();\n      expect(worker.isActive).toBe(false);\n    }\n  });\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Resource Cleanup'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'cleans up on success'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    try\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> result\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">send\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'compute'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, { data: \u003c\\/span>\u003cspan style=\"color:#79B8FF\">42\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(result.value).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">84\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    } \u003c\\/span>\u003cspan style=\"color:#F97583\">finally\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isActive).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">false\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'cleans up on failure'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    try\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">send\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'fail'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, {});\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    } \u003c\\/span>\u003cspan style=\"color:#F97583\">catch\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">      \\/\\/ Expected error\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    } \u003c\\/span>\u003cspan style=\"color:#F97583\">finally\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isActive).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">false\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Testing Worker Lifecycle Events\u003c\\/h3>"},{"type":"code-block","language":"typescript","content":"describe('Lifecycle Events', () => {\n  it('detects worker shutdown', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n    });\n\n    expect(worker.isActive).toBe(true);\n    expect(worker.isConnected).toBe(true);\n\n    await worker.close();\n\n    expect(worker.isActive).toBe(false);\n    expect(worker.isConnected).toBe(false);\n  });\n\n  it('rejects messages after close', async () => {\n    const worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n    });\n\n    await worker.close();\n\n    await expect(worker.send('ping', {})).rejects.toThrow(\\/not active\\/i);\n  });\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Lifecycle Events'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'detects worker shutdown'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isActive).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">true\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isConnected).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">true\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isActive).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">false\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.isConnected).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">false\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'rejects messages after close'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    await\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">close\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(worker.\u003c\\/span>\u003cspan style=\"color:#B392F0\">send\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'ping'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, {})).rejects.\u003c\\/span>\u003cspan style=\"color:#B392F0\">toThrow\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\\/\u003c\\/span>\u003cspan style=\"color:#DBEDFF\">not active\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">\\/\u003c\\/span>\u003cspan style=\"color:#F97583\">i\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch2>CI Considerations\u003c\\/h2>\n\u003ch3>GitHub Actions Example\u003c\\/h3>"},{"type":"code-block","language":"yaml","content":"# .github\\/workflows\\/test.yml\nname: Tests\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions\\/checkout@v4\n\n      - name: Setup Node.js\n        uses: actions\\/setup-node@v4\n        with:\n          node-version: '20'\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Build worker scripts\n        run: npm run build\n\n      - name: Run unit tests\n        run: npm test -- --testPathPattern='\\\\.spec\\\\.ts$'\n\n      - name: Run integration tests\n        run: npm test -- --testPathPattern='\\\\.integration\\\\.ts$'\n        timeout-minutes: 10","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\"># .github\\/workflows\\/test.yml\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Tests\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">on\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: [\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">push\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">pull_request\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">]\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">jobs\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">:\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">  test\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">:\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">    runs-on\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">ubuntu-latest\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">    steps\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">:\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">uses\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">actions\\/checkout@v4\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Setup Node.js\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        uses\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">actions\\/setup-node@v4\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        with\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">:\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">          node-version\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'20'\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Install dependencies\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        run\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">npm ci\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Build worker scripts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        run\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">npm run build\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Run unit tests\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        run\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">npm test -- --testPathPattern='\\\\.spec\\\\.ts$'\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      - \u003c\\/span>\u003cspan style=\"color:#85E89D\">name\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">Run integration tests\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        run\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">npm test -- --testPathPattern='\\\\.integration\\\\.ts$'\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#85E89D\">        timeout-minutes\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">: \u003c\\/span>\u003cspan style=\"color:#79B8FF\">10\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>CI-Specific Timeout Adjustments\u003c\\/h3>\n\u003cp>CI environments are often slower than local machines:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"\\/\\/ test-utils\\/ci-config.ts\nexport const isCI = process.env.CI === 'true';\n\nexport const timeouts = {\n  workerStartup: isCI ? 20000 : 10000,\n  workerMessage: isCI ? 30000 : 10000,\n  testTimeout: isCI ? 60000 : 30000,\n};","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ test-utils\\/ci-config.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">export\u003c\\/span>\u003cspan style=\"color:#F97583\"> const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> isCI\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> process.env.\u003c\\/span>\u003cspan style=\"color:#79B8FF\">CI\u003c\\/span>\u003cspan style=\"color:#F97583\"> ===\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> 'true'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">export\u003c\\/span>\u003cspan style=\"color:#F97583\"> const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> timeouts\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  workerStartup: isCI \u003c\\/span>\u003cspan style=\"color:#F97583\">?\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 20000\u003c\\/span>\u003cspan style=\"color:#F97583\"> :\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 10000\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  workerMessage: isCI \u003c\\/span>\u003cspan style=\"color:#F97583\">?\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 30000\u003c\\/span>\u003cspan style=\"color:#F97583\"> :\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 10000\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  testTimeout: isCI \u003c\\/span>\u003cspan style=\"color:#F97583\">?\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 60000\u003c\\/span>\u003cspan style=\"color:#F97583\"> :\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 30000\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">};\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"code-block","language":"typescript","content":"\\/\\/ integration.spec.ts\nimport { timeouts } from '.\\/test-utils\\/ci-config.js';\n\ndescribe('Integration Tests', () => {\n  let worker: WorkerClient\u003cMessages>;\n\n  beforeAll(async () => {\n    worker = await createWorker\u003cMessages>({\n      script: '.\\/dist\\/worker.js',\n      timeout: {\n        WORKER_STARTUP: timeouts.workerStartup,\n        WORKER_MESSAGE: timeouts.workerMessage,\n      },\n    });\n  }, timeouts.testTimeout);\n\n  \\/\\/ ...tests\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ integration.spec.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { timeouts } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/test-utils\\/ci-config.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Integration Tests'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">  let\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\">:\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/worker-client\" class=\"code-link\" title=\"View WorkerClient documentation\">WorkerClient\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  beforeAll\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#F97583\">async\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    worker \u003c\\/span>\u003cspan style=\"color:#F97583\">=\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      timeout: {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">        WORKER_STARTUP: timeouts.workerStartup,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">        WORKER_MESSAGE: timeouts.workerMessage,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      },\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  }, timeouts.testTimeout);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">  \\/\\/ ...tests\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Avoiding Port\\/Socket Conflicts\u003c\\/h3>\n\u003cp>Run integration tests sequentially to avoid socket conflicts:\u003c\\/p>"},{"type":"code-block","language":"javascript","content":"\\/\\/ jest.config.js\nmodule.exports = {\n  \\/\\/ Run test files sequentially\n  maxWorkers: 1,\n\n  \\/\\/ Or use runInBand for complete isolation\n  \\/\\/ runInBand: true,\n};","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ jest.config.js\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#79B8FF\">module\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">.\u003c\\/span>\u003cspan style=\"color:#79B8FF\">exports\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">  \\/\\/ Run test files sequentially\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  maxWorkers: \u003c\\/span>\u003cspan style=\"color:#79B8FF\">1\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">  \\/\\/ Or use runInBand for complete isolation\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">  \\/\\/ runInBand: true,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">};\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Debugging Failed CI Tests\u003c\\/h3>\n\u003cp>Enable debug logging in CI for troubleshooting:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"const worker = await createWorker\u003cMessages>({\n  script: '.\\/dist\\/worker.js',\n  logLevel: process.env.CI ? 'debug' : 'error',\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> worker\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> await\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/create-worker\" class=\"code-link\" title=\"View createWorker documentation\">createWorker\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  script: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'.\\/dist\\/worker.js'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  logLevel: process.env.\u003c\\/span>\u003cspan style=\"color:#79B8FF\">CI\u003c\\/span>\u003cspan style=\"color:#F97583\"> ?\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> 'debug'\u003c\\/span>\u003cspan style=\"color:#F97583\"> :\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> 'error'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch2>Best Practices Summary\u003c\\/h2>\n\u003col>\n\u003cli>\u003cstrong>Unit test handlers directly\u003c\\/strong> - Extract handler logic into testable functions\u003c\\/li>\n\u003cli>\u003cstrong>Use dependency injection\u003c\\/strong> - Pass dependencies to handlers for easy mocking\u003c\\/li>\n\u003cli>\u003cstrong>Mock workers for host tests\u003c\\/strong> - Avoid process overhead when testing host code\u003c\\/li>\n\u003cli>\u003cstrong>Clean up workers in finally blocks\u003c\\/strong> - Prevent orphaned processes\u003c\\/li>\n\u003cli>\u003cstrong>Adjust timeouts for CI\u003c\\/strong> - CI environments are slower than local machines\u003c\\/li>\n\u003cli>\u003cstrong>Run integration tests sequentially\u003c\\/strong> - Avoid socket conflicts\u003c\\/li>\n\u003cli>\u003cstrong>Separate unit and integration tests\u003c\\/strong> - Run fast tests frequently, slow tests less often\u003c\\/li>\n\u003c\\/ol>\n\u003ch3>Custom Transaction ID Generator Testing\u003c\\/h3>\n\u003cp>When testing code that uses custom transaction ID generators, ensure your generator produces unique IDs:\u003c\\/p>"},{"type":"code-block","language":"typescript","content":"\\/\\/ custom-tx-generator.ts\nexport const customTxIdGenerator: TransactionIdGenerator\u003cMessages> = (\n  message\n) => {\n  return `${message.type}-${Date.now()}-${Math.random()\n    .toString(36)\n    .substr(2, 9)}`;\n};\n\n\\/\\/ custom-tx-generator.spec.ts\nimport { customTxIdGenerator } from '.\\/custom-tx-generator';\n\ndescribe('Custom Transaction ID Generator', () => {\n  it('generates unique IDs for different calls', () => {\n    const id1 = customTxIdGenerator({ type: 'test', payload: {}, tx: 'init' });\n    const id2 = customTxIdGenerator({ type: 'test', payload: {}, tx: 'init' });\n\n    expect(id1).not.toBe(id2);\n  });\n\n  it('includes message type in ID', () => {\n    const id = customTxIdGenerator({\n      type: 'processImage',\n      payload: {},\n      tx: 'init',\n    });\n    expect(id).toContain('processImage');\n  });\n\n  it('generates IDs compatible with transaction tracking', () => {\n    const ids = new Set\u003cstring>();\n    for (let i = 0; i \u003c 1000; i++) {\n      const id = customTxIdGenerator({ type: 'test', payload: {}, tx: 'init' });\n      expect(ids.has(id)).toBe(false);\n      ids.add(id);\n    }\n  });\n});","highlightedHtml":"\u003cpre class=\"shiki github-dark\" style=\"background-color:#00000000;color:#e1e4e8\" tabindex=\"0\">\u003ccode>\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ custom-tx-generator.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">export\u003c\\/span>\u003cspan style=\"color:#F97583\"> const\u003c\\/span>\u003cspan style=\"color:#B392F0\"> customTxIdGenerator\u003c\\/span>\u003cspan style=\"color:#F97583\">:\u003c\\/span>\u003cspan style=\"color:#B392F0\"> \u003ca href=\"\\/isolated-workers\\/api\\/transaction-id-generator\" class=\"code-link\" title=\"View TransactionIdGenerator documentation\">TransactionIdGenerator\u003c\\/a>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#B392F0\">Messages\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">> \u003c\\/span>\u003cspan style=\"color:#F97583\">=\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> (\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#FFAB70\">  message\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">) \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">  return\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> `${\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">message\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">.\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">type\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">}-${\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">Date\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">.\u003c\\/span>\u003cspan style=\"color:#B392F0\">now\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">()\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">}-${\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">Math\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">.\u003c\\/span>\u003cspan style=\"color:#B392F0\">random\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">()\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#9ECBFF\">    .\u003c\\/span>\u003cspan style=\"color:#B392F0\">toString\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">36\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">)\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#9ECBFF\">    .\u003c\\/span>\u003cspan style=\"color:#B392F0\">substr\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">2\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">, \u003c\\/span>\u003cspan style=\"color:#79B8FF\">9\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">)\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">}`\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">};\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#6A737D\">\\/\\/ custom-tx-generator.spec.ts\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">import\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> { customTxIdGenerator } \u003c\\/span>\u003cspan style=\"color:#F97583\">from\u003c\\/span>\u003cspan style=\"color:#9ECBFF\"> '.\\/custom-tx-generator'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">;\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">describe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'Custom Transaction ID Generator'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'generates unique IDs for different calls'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> id1\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> customTxIdGenerator\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ type: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'test'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, payload: {}, tx: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'init'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> id2\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> customTxIdGenerator\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ type: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'test'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, payload: {}, tx: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'init'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(id1).not.\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(id2);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'includes message type in ID'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> id\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> customTxIdGenerator\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      type: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'processImage'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      payload: {},\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      tx: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'init'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">,\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">    expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(id).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toContain\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'processImage'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">  it\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'generates IDs compatible with transaction tracking'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, () \u003c\\/span>\u003cspan style=\"color:#F97583\">=>\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> ids\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#F97583\"> new\u003c\\/span>\u003cspan style=\"color:#B392F0\"> Set\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#79B8FF\">string\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">>();\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">    for\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> (\u003c\\/span>\u003cspan style=\"color:#F97583\">let\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> i \u003c\\/span>\u003cspan style=\"color:#F97583\">=\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 0\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">; i \u003c\\/span>\u003cspan style=\"color:#F97583\">&#x3C;\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> 1000\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">; i\u003c\\/span>\u003cspan style=\"color:#F97583\">++\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">) {\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#F97583\">      const\u003c\\/span>\u003cspan style=\"color:#79B8FF\"> id\u003c\\/span>\u003cspan style=\"color:#F97583\"> =\u003c\\/span>\u003cspan style=\"color:#B392F0\"> customTxIdGenerator\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">({ type: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'test'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">, payload: {}, tx: \u003c\\/span>\u003cspan style=\"color:#9ECBFF\">'init'\u003c\\/span>\u003cspan style=\"color:#E1E4E8\"> });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#B392F0\">      expect\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(ids.\u003c\\/span>\u003cspan style=\"color:#B392F0\">has\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(id)).\u003c\\/span>\u003cspan style=\"color:#B392F0\">toBe\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(\u003c\\/span>\u003cspan style=\"color:#79B8FF\">false\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">      ids.\u003c\\/span>\u003cspan style=\"color:#B392F0\">add\u003c\\/span>\u003cspan style=\"color:#E1E4E8\">(id);\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">    }\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">  });\u003c\\/span>\u003c\\/span>\n\u003cspan class=\"line\">\u003cspan style=\"color:#E1E4E8\">});\u003c\\/span>\u003c\\/span>\u003c\\/code>\u003c\\/pre>"},{"type":"html","html":"\u003ch3>Mock Worker Limitations\u003c\\/h3>\n\u003cp>When using mock workers for testing, be aware that:\u003c\\/p>\n\u003cul>\n\u003cli>\u003cstrong>Mock workers bypass driver capability constraints\u003c\\/strong> - They don't enforce driver-specific features or limitations\u003c\\/li>\n\u003cli>No actual serialization\\/deserialization occurs\u003c\\/li>\n\u003cli>Network\\/IO latency is not simulated\u003c\\/li>\n\u003cli>Real process lifecycle events are not tested\u003c\\/li>\n\u003cli>Socket\\/file cleanup is not verified\u003c\\/li>\n\u003c\\/ul>\n\u003cp>Use real workers in integration tests to verify driver-specific behavior, especially when:\u003c\\/p>\n\u003cul>\n\u003cli>Testing serialization formats or custom serializers\u003c\\/li>\n\u003cli>Verifying timeout handling across process boundaries\u003c\\/li>\n\u003cli>Validating error propagation through actual IPC\u003c\\/li>\n\u003cli>Testing resource limits or worker crashes\u003c\\/li>\n\u003c\\/ul>\n\u003ch2>See Also\u003c\\/h2>\n\u003cul>\n\u003cli>\u003ca href=\"\\/isolated-workers\\/docs\\/guides\\/error-handling\">Error Handling\u003c\\/a> - Testing error propagation\u003c\\/li>\n\u003cli>\u003ca href=\"\\/isolated-workers\\/docs\\/guides\\/worker-lifecycle\">Worker Lifecycle\u003c\\/a> - Testing lifecycle events\u003c\\/li>\n\u003cli>\u003ca href=\"\\/isolated-workers\\/docs\\/guides\\/timeout-configuration\">Timeout Configuration\u003c\\/a> - Configuring test timeouts\u003c\\/li>\n\u003c\\/ul>"}]}}</script>
        <script id="vike_globalContext" type="application/json">{"navigation":[{"title":"Getting Started","children":[{"title":"Installation","path":"\\/docs\\/getting-started\\/installation","order":0},{"title":"Quick Start","path":"\\/docs\\/getting-started\\/quick-start","order":2},{"title":"Building Your First Worker","path":"\\/docs\\/getting-started\\/first-worker","order":3}],"order":0,"path":"\\/docs\\/getting-started"},{"title":"Concepts","children":[{"title":"Why isolated-workers?","path":"\\/docs\\/concepts\\/why-isolated-workers","order":1},{"title":"Drivers","path":"\\/docs\\/concepts\\/drivers","order":3}],"order":10,"path":"\\/docs\\/concepts"},{"title":"Guides","children":[{"title":"Error Handling","path":"\\/docs\\/guides\\/error-handling","order":1},{"title":"Middleware","path":"\\/docs\\/guides\\/middleware","order":2},{"title":"Timeout Configuration","path":"\\/docs\\/guides\\/timeout-configuration","order":3},{"title":"Custom Serializers","path":"\\/docs\\/guides\\/custom-serializers","order":4},{"title":"Worker Lifecycle","path":"\\/docs\\/guides\\/worker-lifecycle","order":5},{"title":"TypeScript Deep Dive","path":"\\/docs\\/guides\\/typescript","order":6},{"title":"Troubleshooting","path":"\\/docs\\/guides\\/troubleshooting","order":7},{"title":"Testing Workers","path":"\\/docs\\/guides\\/testing","order":8},{"title":"Security Considerations","path":"\\/docs\\/guides\\/security","order":9}],"order":20,"path":"\\/docs\\/guides"},{"title":"Examples","path":"\\/examples","children":[{"title":"Basic Ping-Pong Worker","path":"\\/examples\\/basic-ping"},{"title":"Custom Serializer","path":"\\/examples\\/custom-serializer"},{"title":"Error Handling","path":"\\/examples\\/error-handling"},{"title":"Middleware Pipeline","path":"\\/examples\\/middleware"},{"title":"Timeout Configuration","path":"\\/examples\\/timeout-config"},{"title":"Unexpected Worker Shutdown Handling","path":"\\/examples\\/shutdown-handling"},{"title":"Worker Lifecycle Management","path":"\\/examples\\/worker-lifecycle"},{"title":"Worker Threads Driver","path":"\\/examples\\/worker-threads-driver"}],"order":100},{"title":"API Reference","path":"\\/api","children":[{"title":"Configuration","path":"\\/api#configuration","children":[{"title":"Handlers","path":"\\/api\\/handlers"},{"title":"Middleware","path":"\\/api\\/middleware"}]},{"title":"Core","path":"\\/api#core","children":[{"title":"createWorker","path":"\\/api\\/create-worker"},{"title":"startWorkerServer","path":"\\/api\\/start-worker-server"}]},{"title":"Drivers","path":"\\/api#drivers","children":[{"title":"ChildProcessCapabilities","path":"\\/api\\/child-process-capabilities"},{"title":"Driver","path":"\\/api\\/driver"},{"title":"DriverCapabilities","path":"\\/api\\/driver-capabilities"},{"title":"WorkerThreadsCapabilities","path":"\\/api\\/worker-threads-capabilities"}]},{"title":"Other","path":"\\/api#other","children":[{"title":"AllMessages","path":"\\/api\\/all-messages"},{"title":"AllResults","path":"\\/api\\/all-results"},{"title":"AnyMessage","path":"\\/api\\/any-message"},{"title":"BaseMessage","path":"\\/api\\/base-message"},{"title":"BuiltInTimeoutKey","path":"\\/api\\/built-in-timeout-key"},{"title":"ChildProcessChannel","path":"\\/api\\/child-process-channel"},{"title":"ChildProcessDriver","path":"\\/api\\/child-process-driver"},{"title":"ChildProcessDriverOptions","path":"\\/api\\/child-process-driver-options"},{"title":"ChildProcessDriverOptions","path":"\\/api\\/child-process-driver-options"},{"title":"ChildProcessDriverType","path":"\\/api\\/child-process-driver-type"},{"title":"ChildProcessServerChannel","path":"\\/api\\/child-process-server-channel"},{"title":"ChildProcessStartupData","path":"\\/api\\/child-process-startup-data"},{"title":"Connection","path":"\\/api\\/connection"},{"title":"ConnectionOptions","path":"\\/api\\/connection-options"},{"title":"createServer","path":"\\/api\\/create-server"},{"title":"createServer","path":"\\/api\\/create-server"},{"title":"DEFAULT_SERVER_CONNECT_TIMEOUT","path":"\\/api\\/default-server-connect-timeout"},{"title":"defaultLogger","path":"\\/api\\/default-logger"},{"title":"DetachCapability","path":"\\/api\\/detach-capability"},{"title":"DriverChannel","path":"\\/api\\/driver-channel"},{"title":"DriverMessage","path":"\\/api\\/driver-message"},{"title":"DriverOptionsFor","path":"\\/api\\/driver-options-for"},{"title":"encodeStartupData","path":"\\/api\\/encode-startup-data"},{"title":"Logger","path":"\\/api\\/logger"},{"title":"LogLevel","path":"\\/api\\/log-level"},{"title":"MaybePromise","path":"\\/api\\/maybe-promise"},{"title":"MessageDef","path":"\\/api\\/message-def"},{"title":"MessageDefs","path":"\\/api\\/message-defs"},{"title":"MessageHandler","path":"\\/api\\/message-handler"},{"title":"MessageOf","path":"\\/api\\/message-of"},{"title":"MessageResult","path":"\\/api\\/message-result"},{"title":"MessageType","path":"\\/api\\/message-type"},{"title":"MiddlewareContext","path":"\\/api\\/middleware-context"},{"title":"MiddlewareDirection","path":"\\/api\\/middleware-direction"},{"title":"PayloadOf","path":"\\/api\\/payload-of"},{"title":"ReconnectCapability","path":"\\/api\\/reconnect-capability"},{"title":"ResponseFunction","path":"\\/api\\/response-function"},{"title":"ResponseFunction","path":"\\/api\\/response-function"},{"title":"ResultOf","path":"\\/api\\/result-of"},{"title":"ResultPayloadOf","path":"\\/api\\/result-payload-of"},{"title":"ServerChannel","path":"\\/api\\/server-channel"},{"title":"ServerDriver","path":"\\/api\\/server-driver"},{"title":"ServerOptions","path":"\\/api\\/server-options"},{"title":"ShutdownReason","path":"\\/api\\/shutdown-reason"},{"title":"spawnWorker","path":"\\/api\\/spawn-worker"},{"title":"spawnWorker","path":"\\/api\\/spawn-worker"},{"title":"STARTUP_DATA_ENV_KEY","path":"\\/api\\/startup-data-env-key"},{"title":"STARTUP_DATA_WORKER_KEY","path":"\\/api\\/startup-data-worker-key"},{"title":"TimeoutConfig","path":"\\/api\\/timeout-config"},{"title":"TransactionIdGenerator","path":"\\/api\\/transaction-id-generator"},{"title":"TypedMessage","path":"\\/api\\/typed-message"},{"title":"TypedResult","path":"\\/api\\/typed-result"},{"title":"UnexpectedShutdownConfig","path":"\\/api\\/unexpected-shutdown-config"},{"title":"UnexpectedShutdownStrategy","path":"\\/api\\/unexpected-shutdown-strategy"},{"title":"WorkerClient","path":"\\/api\\/worker-client"},{"title":"WorkerCrashedError","path":"\\/api\\/worker-crashed-error"},{"title":"WorkerHandler","path":"\\/api\\/worker-handler"},{"title":"WorkerHandlers","path":"\\/api\\/worker-handlers"},{"title":"WorkerOptions","path":"\\/api\\/worker-options"},{"title":"WorkerServer","path":"\\/api\\/worker-server"},{"title":"WorkerServerOptions","path":"\\/api\\/worker-server-options"},{"title":"WorkerThreadsChannel","path":"\\/api\\/worker-threads-channel"},{"title":"WorkerThreadsDriver","path":"\\/api\\/worker-threads-driver"},{"title":"WorkerThreadsDriverOptions","path":"\\/api\\/worker-threads-driver-options"},{"title":"WorkerThreadsDriverOptions","path":"\\/api\\/worker-threads-driver-options"},{"title":"WorkerThreadsDriverType","path":"\\/api\\/worker-threads-driver-type"},{"title":"WorkerThreadsResourceLimits","path":"\\/api\\/worker-threads-resource-limits"},{"title":"WorkerThreadsResourceLimits","path":"\\/api\\/worker-threads-resource-limits"},{"title":"WorkerThreadsServerChannel","path":"\\/api\\/worker-threads-server-channel"},{"title":"WorkerThreadsStartupData","path":"\\/api\\/worker-threads-startup-data"}]},{"title":"Serialization","path":"\\/api#serialization","children":[{"title":"JsonSerializer","path":"\\/api\\/json-serializer"},{"title":"Serializer","path":"\\/api\\/serializer"}]},{"title":"Types","path":"\\/api#types","children":[{"title":"DefineMessages","path":"\\/api\\/define-messages"},{"title":"WithResult","path":"\\/api\\/with-result"}]}],"order":200},{"title":"Configuration","children":[{"title":"Shutdown Handling","path":"\\/docs\\/guides\\/shutdown-handling","order":4}]},{"title":"Resources","children":[{"title":"FAQ","path":"\\/docs\\/faq","order":0},{"title":"Contributing","path":"\\/docs\\/contributing","order":1}]}],"examples":{"basic-ping":{"id":"basic-ping","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/basic-ping","title":"Basic Ping-Pong Worker","description":"A simple example demonstrating the basics of isolated-workers: spawning a worker process, sending messages, and receiving responses. This example shows the fundamental request\\/response pattern with type-safe message definitions.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:basic-ping","title":"Run the example","assertions":[{"contains":"Worker spawned with PID"},{"contains":"Received response:"},{"contains":"Worker closed successfully"}]}],"hidden":false},"custom-serializer":{"id":"custom-serializer","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/custom-serializer","title":"Custom Serializer","description":"Shows how to implement and use a custom serializer for message encoding. This is useful for using binary formats like MessagePack, adding compression, or wrapping messages with metadata. Both host and worker must use the same serializer.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./serializer.ts":"serializer.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:custom-serializer","title":"Run the example","assertions":[{"contains":"VerboseJsonSerializer"},{"contains":"[SERIALIZER] Message #"},{"contains":"HELLO, CUSTOM SERIALIZER!"},{"contains":"Worker closed successfully"}]}],"hidden":false},"error-handling":{"id":"error-handling","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/error-handling","title":"Error Handling","description":"Demonstrates how errors thrown in worker handlers propagate back to the host,\nincluding error messages and proper cleanup.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:error-handling","title":"Run the example","assertions":[{"contains":"Test 1: 10 \\/ 2"},{"contains":"Result: 5"},{"contains":"Test 2: 10 \\/ 0 (should error)"},{"contains":"Division by zero"},{"contains":"All tests passed"}]}],"hidden":false},"image-processing":{"id":"image-processing","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/image-processing","title":"Image Processing Worker","description":"A complete example demonstrating how to build a production-ready worker\nfor CPU-intensive tasks like image processing. Shows type-safe messaging,\nper-operation timeouts, worker state, and batch processing.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:image-processing","title":"Run the example","assertions":[{"contains":"Worker PID:"},{"contains":"Image metadata:"},{"contains":"Worker status:"},{"contains":"Batch result:"},{"contains":"Worker shut down gracefully"}]}],"hidden":true},"middleware":{"id":"middleware","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/middleware","title":"Middleware Pipeline","description":"Demonstrates how to use middleware to intercept and process messages. Middleware can log messages, add metadata, validate structure, or transform payloads. Both the host and worker can have their own middleware pipelines.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:middleware","title":"Run the example","assertions":[{"contains":"[OUTGOING]"},{"contains":"[INCOMING]"},{"contains":"Hello, World!"},{"contains":"Worker closed successfully"}]}],"hidden":false},"readme-snippets":{"id":"readme-snippets","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/readme-snippets","title":"README Code Snippets","description":"Type-checked code snippets used in the package README.\nThis example is hidden from navigation.\n","entryPoint":"drivers.ts","fileMap":{"./drivers.ts":"drivers.ts","./api-overview.ts":"api-overview.ts"},"commands":"!undefined","hidden":true},"shutdown-handling":{"id":"shutdown-handling","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/shutdown-handling","title":"Unexpected Worker Shutdown Handling","description":"Demonstrates how to handle unexpected worker crashes with configurable\nretry strategies, per-message-type overrides, and detailed error context.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:shutdown-handling","title":"Run the example","assertions":[{"contains":"Test 1: Normal operation"},{"contains":"Result: 25"},{"contains":"Test 2: Idempotent operation with crash - retry exhaustion"},{"contains":"WorkerCrashedError after retries"},{"contains":"Attempt: 3\\/3"},{"contains":"Test 3: Non-idempotent operation"},{"contains":"Attempt: 1\\/1"},{"contains":"No retries"},{"contains":"Test 4: Batch processing with retry exhaustion"},{"contains":"Test 5: Successful batch processing"},{"contains":"Processed batch of 3 items"}]}],"hidden":false},"timeout-config":{"id":"timeout-config","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/timeout-config","title":"Timeout Configuration","description":"Demonstrates the flexible timeout configuration system. You can set timeouts for worker startup, server connection, a default message timeout, and per-message-type timeouts for fine-grained control over long-running operations.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:timeout-config","title":"Run the example","assertions":[{"contains":"Timeout configuration:"},{"contains":"Quick ping completed"},{"contains":"Slow process completed"},{"contains":"Worker closed successfully"}]}],"hidden":false},"worker-lifecycle":{"id":"worker-lifecycle","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/worker-lifecycle","title":"Worker Lifecycle Management","description":"Demonstrates worker lifecycle management including status checking (isActive, isConnected), state persistence across requests, and graceful shutdown. Shows how workers maintain state between messages and how to handle the worker after it's closed.\n","entryPoint":"host.ts","fileMap":{"./messages.ts":"messages.ts","./host.ts":"host.ts","./worker.ts":"worker.ts"},"commands":[{"command":"pnpm run:worker-lifecycle","title":"Run the example","assertions":[{"contains":"Worker Created"},{"contains":"isActive: true"},{"contains":"isConnected: true"},{"contains":"Request count:"},{"contains":"isActive: false"},{"contains":"Worker is not active"}]}],"hidden":false},"worker-threads-driver":{"id":"worker-threads-driver","path":"\\/home\\/runner\\/work\\/isolated-workers\\/isolated-workers\\/examples\\/worker-threads-driver","title":"Worker Threads Driver","description":"Use the worker_threads driver for in-process workers with shared memory support.\nWorker threads run in the same process as the host, enabling SharedArrayBuffer\nand lower overhead compared to child processes.\n","entryPoint":"host.ts","fileMap":"!undefined","commands":[{"command":"node --import tsx {filename}","title":"Run worker threads example","assertions":[{"contains":"Result:"},{"contains":"Worker threads driver"}]}],"hidden":false}}}</script>
        <script src="/isolated-workers/assets/entries/entry-client-routing.io56qHg_.js" type="module" async></script>
        <link rel="modulepreload" href="/isolated-workers/assets/entries/pages_docs.D3lD6bTo.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-CoIusrxJ.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-B01QXYmX.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-DApX3sgb.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-Dzd9oD5V.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-jQ2pk9iw.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/isolated-workers/assets/chunks/chunk-Y59L1pI7.js" as="script" type="text/javascript">
      </body>
    </html>